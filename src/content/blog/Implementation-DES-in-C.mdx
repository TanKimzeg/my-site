---
title: Cè¯­è¨€å®ç°DESå¯†ç ç®—æ³•
description: "ä¸ºåŠ æ·±å¯¹DESå¯†ç ç®—æ³•çš„ç†è§£è€Œç”¨Cè¯­è¨€ç¼–ç¨‹å®ç°"
pubDate: 2025 04 11 
categories: 
  - tech
tags:
  - software
  - crypto
---

import RepositoryCard from "@/components/mdx/RepositoryCard.astro";

é¡¹ç›®åœ°å€ï¼š
<RepositoryCard repo="TanKimzeg/uno" image="https://github.com/PrekrasnoyeDalekov/DES"/>

> æœ¬é¡¹ç›®çº¦700è¡Œä»£ç ,ä»¥åå°†è€ƒè™‘å¢åŠ å¤šçº¿ç¨‹çš„åŠŸèƒ½.

## DESç®€ä»‹

DESå…¨ç§°ä¸ºData Encryption  Standardï¼Œå³æ•°æ®åŠ å¯†æ ‡å‡†ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å¯†é’¥åŠ å¯†çš„**å¯¹ç§°å¯†ç ç®—æ³•**ï¼Œ1977å¹´è¢«ç¾å›½è”é‚¦æ”¿åºœçš„å›½å®¶æ ‡å‡†å±€ç¡®å®šä¸ºè”é‚¦èµ„æ–™å¤„ç†æ ‡å‡†ï¼ˆFIPSï¼‰ï¼Œå¹¶æˆæƒåœ¨éå¯†çº§æ”¿åºœé€šä¿¡ä¸­ä½¿ç”¨ï¼Œéšåè¯¥ç®—æ³•åœ¨å›½é™…ä¸Šå¹¿æ³›æµä¼ å¼€æ¥ã€‚

æœ‰å…³DESç®—æ³•æœ¬èº«çš„è¿‡ç¨‹å’ŒåŸç†,æ•™ç§‘ä¹¦å’Œç½‘ä¸Šéƒ½æœ‰å¤§é‡èµ„æ–™,è¿™é‡Œä¸å†èµ˜è¿°.æœ¬æ–‡ä¸»è¦è®²æˆ‘å†™ä»£ç çš„è¿‡ç¨‹ä»¥åŠè§£å†³çš„é—®é¢˜.

## å¯†é’¥å¤„ç†

DESçš„å¯†é’¥æ˜¯64ä½,å…¶ä¸­8ä½ä¸ç”¨,å…¶å®æ˜¯56ä½çš„å¯†é’¥ç©ºé—´.åŠ å¯†å’Œè§£å¯†,16è½®å˜æ¢,é¦–å…ˆéƒ½éœ€è¦å…ˆäº§ç”Ÿå­å¯†é’¥.æˆ‘ä¹Ÿæ˜¯ä»è¿™é‡Œå…¥æ‰‹çš„.

![å­å¯†é’¥çš„ç”Ÿæˆ](attachments/Cè¯­è¨€å®ç°DESå¯†ç ç®—æ³•-å­å¯†é’¥çš„ç”Ÿæˆ.png)

é¦–å…ˆåˆå§‹å¯†é’¥64ä½ç»è¿‡å‹ç¼©ç½®æ¢1å˜ä¸º56ä½,åˆ†å‰²ä¸ºå·¦è¾¹28ä½C0å’Œå³è¾¹28ä½D0.ä¹‹åçš„$C_{i}$å’Œ$D_{i}$éƒ½æ˜¯ç”±$C_{i-1}$å’Œ$D_{i-1}$å¾ªç¯å·¦ç§»å¾—åˆ°çš„.

$C_{i}$å’Œ$D_{i}$æ‹¼åœ¨ä¸€èµ·å¾—åˆ°56ä½,å†ç»è¿‡å‹ç¼©å˜æ¢2å˜æˆ48ä½çš„$K_{i}(i=1,2,3,\dots,16)$æ˜¯16è½®feistelç½‘ç»œå˜æ¢çš„å­å¯†é’¥.

åœ¨æˆ‘çš„ä»£ç ä¸­,[cipher.c](https://github.com/PrekrasnoyeDalekov/DES/blob/main/cipherkey.c)çš„ `fill_CDK`å‡½æ•°å®ç°äº†16è½®å­å¯†é’¥çš„ç”Ÿæˆ.

å‹ç¼©ç½®æ¢1(PC_1)å’Œå‹ç¼©ç½®æ¢2(PC_2)çš„å«ä¹‰æ˜¯,ç¬¬iä¸ªä½ç½®ä¸ºåŸæ•°æ®çš„ç¬¬PC_1[i]/PC_2[i]ä½(æœ‰ç‚¹ç»•å¯¹å§)

## 64ä½æ•°æ®çš„åŠ å¯†è¿‡ç¨‹

åœ¨[encrypt.c](https://github.com/PrekrasnoyeDalekov/DES/blob/main/encrypt.c)ä¸­,æˆ‘å®ç°äº†å¯¹ä¸€ä¸ªå®Œæ•´8å­—èŠ‚æ•°æ®çš„åŠ å¯†.

![åŠ å¯†è¿‡ç¨‹](attachments/Cè¯­è¨€å®ç°DESå¯†ç ç®—æ³•-åŠ å¯†è¿‡ç¨‹.png)
*åŠ å¯†è¿‡ç¨‹*

![få‡½æ•°](attachments/Cè¯­è¨€å®ç°DESå¯†ç ç®—æ³•-få‡½æ•°.png)
*få‡½æ•°*




## 64ä½æ•°æ®çš„è§£å¯†è¿‡ç¨‹

è§£å¯†è¿‡ç¨‹å®é™…ä¸Šå’ŒåŠ å¯†è¿‡ç¨‹çš„æ­¥éª¤**ç›¸åŒ**,åªæ˜¯æ¯ä¸€è½®çš„å¯†é’¥æ˜¯åŠ å¯†çš„å¯†é’¥çš„é€†åº.è¿™æ­£æ˜¯è¿™ä¸€å¯¹ç§°å¯†ç ç®—æ³•çš„ç²¾å¦™ä¹‹å¤„.

## æ¶ˆæ¯åŠ å¯†è§£å¯†,æ–‡ä»¶åŠ å¯†è§£å¯†çš„å®ç°

å…¶å®,å®Œæˆä»¥ä¸Š8å­—èŠ‚çš„åŠ å¯†è§£å¯†,ä¼°è®¡å·²ç»èƒ½äº¤"å®éªŒæŠ¥å‘Š"äº†.ä½†æ˜¯ä½œä¸ºæˆ‘è¿™ç§æ°´å¹³çš„äºº,æ€ä¹ˆå¯èƒ½æ­¢æ­¥äºæ­¤?äºæ˜¯,æˆ‘å¼€å¯äº†æ–‡ä»¶IOçš„è‡ªæˆ‘æŠ˜ç£¨.


> DESå¯†ç ç®—æ³•å¤„ç†æ•°æ®æŒ‰å­—èŠ‚æµè¿›è¡Œ(ç±»ä¼¼äºå¤§ç«¯åº),è€Œåœ¨å¤§å¤šæ•°æ™ºèƒ½è®¾å¤‡ä¸Š,å­˜å‚¨æ•´æ•°çš„å­—èŠ‚åºæ˜¯å°ç«¯åº.64ä½æ•°æ®æ˜¯DESåŠ å¯†è§£å¯†çš„æœ€å°å•å…ƒ,æˆ‘ä¸€å¼€å§‹æŠŠè¿™64ä½æ•°æ®çœŸçš„å½“æˆäº†ä¸€ä¸ª"æ•°"è€Œé‡‡ç”¨äº†å°ç«¯åº(ä¸ºäº†åŠ å¯†åçš„ç»“æœæ˜¯åå…­è¿›åˆ¶çš„***å¯è§†å­—ç¬¦ä¸²æ•°å­—***),é¡¹ç›®å‡ ä¹å®Œæˆåæ‰å‘è§‰ä¸å¤ªå¥½,å› ä¸º`fscanf`å‡½æ•°è¯»å–åå…­è¿›åˆ¶çš„`unsinged long long`å¯èƒ½å½±å“æ•ˆç‡,ä¸å¦‚`fread`å‡½æ•°ä¸€æ¬¡æ€§è¯»å–8å­—èŠ‚å¿«.ç”±äºæˆ‘æ™®éé‡‡ç”¨äº†è¿™ä¸€é€»è¾‘,å…¶å®ä¹Ÿæœ‰åˆ©æœ‰å¼Š,(çœ‹åˆ°åŠ å¯†åçš„HEXæ•°å­—,èƒ½å¢å¼ºæˆ‘è°ƒè¯•çš„ä¿¡å¿ƒğŸ˜†;ä½†æ˜¯ä½œä¸ºå®Œç¾ä¸»ä¹‰è€…,åˆå¿ä¸ä½æƒ³ä¼˜åŒ–).æœ¬é¡¹ç›®ä»…ä½œä¸ºæ¼”ç¤ºDESç®—æ³•,å°†å°±è¿™æ ·äº†.è¯»è€…åº”æƒ³æ¸…æ¥šè¿™ä¸€ç‚¹,é€‰æ‹©åˆé€‚è‡ªå·±çš„å®è·µæ–¹å¼.

é¦–å…ˆ,DESç®—æ³•æ˜¯åˆ†å—åŠ å¯†ç®—æ³•,æ¯ä¸ªæ•°æ®å—éƒ½æ˜¯8å­—èŠ‚,å¯¹äºæ–‡æœ¬å’Œæ–‡ä»¶æ¥è¯´,å¦‚æœå¤§å°ä¸æ˜¯8å­—èŠ‚çš„å€æ•°,å°±éœ€è¦è¡¥é½.

æœ¬é¡¹ç›®é‡‡ç”¨çš„æ˜¯**PKCS7**å¡«å……è§„åˆ™:
- å¯¹äºæœ«å°¾ä¸æ»¡8å­—èŠ‚çš„æ•°æ®å—,ç¼ºiä¸ªå­—èŠ‚,å°±å¡«å……iä¸ªå­—èŠ‚,ä¸”å¡«å……å­—èŠ‚çš„å€¼ä¸ºi.
- å¯¹äºæœ«å°¾æ»¡8å­—èŠ‚çš„æ•°æ®å—,å¡«å……8ä¸ª`0x08`å­—èŠ‚

å¦‚æœåªæœ‰ç¬¬ä¸€æ¡è§„åˆ™æ²¡æœ‰ç¬¬äºŒæ¡è§„åˆ™,å¯èƒ½å‡ºç°ä¸€ç§æƒ…å†µå°±æ˜¯æ•°æ®å—æ˜¯8å­—èŠ‚ä½†æœ€åä¸€ä¸ªå­—èŠ‚æ˜¯0x01,è¿™æ ·ä¼šæ— æ³•åˆ¤æ–­æ˜¯å¦å‰¥å»è¿™ä¸ªå­—èŠ‚.

> æˆ‘çš„å°ç«¯åºå®ç°ä¸å½±å“PKCS7å¡«å……,è¯»è€…å¯ä»¥æƒ³æƒ³ä¸ºä»€ä¹ˆ.

æˆ‘çš„ä»£ç ä¸­æä¾›äº†
`encryptMessage`, `encryptFile`, `decryptMessgae`å’Œ `decryptFile`å‡½æ•°æ¥åˆ†åˆ«å®ç°åŠ å¯†å’Œè§£å¯†,ä»–ä»¬è¯»å–é€»è¾‘éƒ½ä¸å¤ªä¸€æ ·,ååˆ†çƒ§è„‘!è¿˜å¥½æˆ‘æœ‰Github Copilot,å¸®äº†æˆ‘ä¸€ç‚¹å¿™.

è¯´å®è¯,è¿™æ ·æ··ä¹±çš„è¯»å–é€»è¾‘è®©æˆ‘ååˆ†ä¸æ»¡æ„,ä½†æˆ–è®¸æ¶‰åŠæ–‡ä»¶IOéƒ½æ˜¯å¦‚æ­¤å§,ä¹‹å‰ç½‘ç»œç¼–ç¨‹çš„æ—¶å€™`receive`å’Œ `send`ä¹Ÿæ˜¯ç›¸ä¼¼çš„æ„Ÿè§‰,é‚£æ—¶åªéœ€è€ƒè™‘è¯»å‡€å†™å‡€,è¿™é‡Œè¿˜è¦è€ƒè™‘format,ååˆ†æ¶å¿ƒ.

## æ–‡ä»¶é‡å®šå‘çš„å¤„ç†

æœ€åç¼–å†™`main`å‡½æ•°,æ ¹æ®ç¨‹åºè®¾è®¡çš„åŠŸèƒ½å’Œç”¨æˆ·è¾“å…¥æ¥ç¡®å®šç¨‹åºçš„é€»è¾‘æµ,å¤šä¸€äº›åˆ¤æ–­å¢å¼ºç¨‹åºçš„å¥å£®æ€§,æœ€åæå¾—è·ŸGNUå‘½ä»¤è¡Œè½¯ä»¶ä¸€æ ·æœ‰æ¨¡æœ‰æ ·ğŸ˜:

```shell
$ ./DES -h
Usage: ./DES [-e | -d] -k <key> [-x <hex> | -m <message> | -f <file>] [-o <output>] [-h] [-v]
Options:
  -e            Encrypt the input (message, file or 64-bit hex number).
  -d            Decrypt the input (message, file or 64-bit hex number).
  -k <key>      Specify the encryption/decryption key (required).      
  -x <hex>      Specify the hex number to encrypt or decrypt.
  -m <message>  Specify the message to encrypt or decrypt.
  -f <file>     Specify the file to encrypt or decrypt.
  -o <output>   Specify the output file for encrypted/decrypted data, default STDOUT.
  -h            Display this help message.
  -v            Enable verbose mode for detailed output.

Examples:
  ./DES -e -k 0x12345678 -x 0x789abc -v
  ./DES -e -k 0x12345678 -m "Hello, World!"
  ./DES -e -k 0x12345678 -f input.txt -o encrypted_file.txt
  ./DES -d -k 0x12345678 -f encrypted_file.txt -o decrypted_file.txt   
```

ä½†è¿˜æœ‰ä¸€å…³:æ¢è¡Œç¬¦æ ¼å¼

æˆ‘ä»¬çŸ¥é“,Windowsæ–‡æœ¬ä½¿ç”¨CRLF(å³\r\n)æ¥æ¢è¡Œ,è€Œåœ¨Cè¯­è¨€ä¸­`printf("\n")`å³å¯æ¢è¡Œ,è¿™æ˜¯å› ä¸ºWindowsä¸‹è‡ªåŠ¨ç»™Cçš„æ ‡å‡†è¾“å‡ºæµçš„`\n`æ›¿æ¢ä¸º`\r\n`.

è¿™ä¼šå¸¦æ¥ä¸€ä¸ªä»€ä¹ˆé—®é¢˜å‘¢?å½“æˆ‘æŠŠä¸€ä¸ªCRLFæ–‡ä»¶åŠ å¯†,å¯†æ–‡é‡Œé¢éšè—äº†`\r\n`,è€Œå½“æˆ‘è¾“å‡ºè§£å¯†åçš„æ˜æ–‡æ—¶,Windowsä¸‹çš„Cä¼šå°†`\n`æ›¿æ¢ä¸º`\r\n`,äºæ˜¯å°±å˜æˆäº†`\r\n\n`,æ¢äº†ä¸¤è¡Œ.

æˆ‘å‘ç°è¿™ä¸ªç°è±¡,ä¸ä»…ä»…æ˜¯æ–‡æœ¬æ–‡ä»¶ä¼šå‘ç”Ÿ,æ‰€æœ‰fprintf(stdout)éƒ½ä¼šæ‰§è¡Œä¸åˆ†é’çº¢çš‚ç™½çš„æ›¿æ¢,åªè¦å®ƒé‡åˆ°`\n`(å¥½åƒæ˜¯0x0a)è¿™ä¸ªå­—èŠ‚,è‡ªåŠ¨æ›¿æ¢ä¸º0x0d0a,è¿™å°±å¯¼è‡´äº†å¤§å¤šæ•°æ—¶å€™ç»è¿‡åŠ å¯†è§£å¯†åmd5æ ¡éªŒå’Œä¸ä¸€è‡´.

æˆ‘é—®Github Copilot,å®ƒç»™æˆ‘çš„è§£å†³æ–¹æ³•æ˜¯:

```c
#ifdef _WIN32
#include <windows.h>
#include <fcntl.h>
#include <io.h>
#endif
```

ä»¥åŠ

```c
int main(int argc, char *argv[]) {
#ifdef _WIN32
	_setmode(_fileno(stdout), _O_BINARY);
#endif
	...
}
```

è¿™æ ·,å°±ä¸ä¼šè‡ªåŠ¨ä¿®æ”¹ä¸ºCRLF.

ç›®å‰ä¸ºæ­¢,è¾“å‡ºé‡å®šå‘ç”¨çš„æ˜¯ç»ˆç«¯ä¸­çš„ `>`,æ¯”å¦‚:
```shell
./DES -d -k 0x999 -f "encrypted_file" > "decrypted_file"
```
åœ¨cmdä¸­ç¡®å®æ²¡é—®é¢˜äº†,ä½†æ˜¯ä¸€æ—¦åœ¨Powshellä¸­è¿è¡Œåˆä¸è¡Œäº†.

Github Copilotæ•™æˆ‘è¿™æ ·æ£€æŸ¥æ–‡ä»¶çš„å†…å®¹:
```shell
Get-Content -Path "yourfile.txt" -Raw | Format-Hex
```
æˆ‘å‘ç°ç›¸è¾ƒäºcmdçš„è¾“å‡º,Powershellçš„è¾“å‡ºåœ¨æ–‡ä»¶æœ«å°¾å¤šäº†`0x0D0A`,æ­£æ˜¯`\r\n`.

è¯¶,æˆ‘ä¸æ˜¯æ˜æ˜å·²ç»é’ˆå¯¹è¿™ç§è¡Œä¸ºåŠ å…¥äº†é‚£ä¸ªå¥‡æ€ªçš„`_setmode`å‡½æ•°å—?è€Œä¸”cmdä¸­æ˜¯æ­£ç¡®çš„.

Copilotåˆå‘Šè¯‰æˆ‘,è¿™å·²ç»ä¸æ˜¯Windowsä¸‹Cçš„è¡Œä¸ºäº†,è€Œæ˜¯Powershellè‡ªå·±çš„è¡Œä¸º.å®ƒå°†`>`é‡å®šå‘é»˜è®¤å½“ä½œæ˜¯æ–‡æœ¬æ–‡ä»¶,å¹¶ä¸”åœ¨æœ€ååŠ ä¸Š`\r\n`æ¥è½¬æ¢ä¸ºWindowsçš„CRLFæ–‡æœ¬æ–‡ä»¶æ ¼å¼.

å“,çœŸæ˜¯æ‹¿ä½ æ²¡åŠæ³•å‘¢.ä¸ºäº†å…¼å®¹æ€§,æˆ‘å¹²è„†å¢åŠ äº†ä¸€ä¸ªoutputé€‰é¡¹,è¿™å°±æ˜¯æœ€ç»ˆç‰ˆ.

## ç¨‹åºæµ‹è¯•

æ–‡ä»¶ç»è¿‡åŠ å¯†å’Œè§£å¯†,MD5æ ¡éªŒå’Œä¸åŸæ–‡ä»¶ä¸€è‡´,è¯´æ˜ç¨‹åºæ‰§è¡Œé€»è¾‘æ­£ç¡®!

```shell
PS > .\DES.exe -e -k 0x999 -f DES.exe -o encrypted
PS > .\DES.exe -d -k 0x999 -f encrypted -o decrypted
PS > md5sum .\DES.exe
\0319c765a2e54d3dc02520e11b2f3145 *.\\DES.exe
PS > md5sum .\decrypted
\0319c765a2e54d3dc02520e11b2f3145 *.\\decrypted
```